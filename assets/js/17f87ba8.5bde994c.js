"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6367],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>b});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),p=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},u=function(e){var n=p(e.components);return r.createElement(c.Provider,{value:n},e.children)},s="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),s=p(t),m=o,b=s["".concat(c,".").concat(m)]||s[m]||d[m]||a;return t?r.createElement(b,l(l({ref:n},u),{},{components:t})):r.createElement(b,l({ref:n},u))}));function b(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,l=new Array(a);l[0]=m;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i[s]="string"==typeof e?e:o,l[1]=i;for(var p=2;p<a;p++)l[p]=t[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},4366:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var r=t(7462),o=(t(7294),t(3905));const a={},l="webpack",i={unversionedId:"micfrontend/README",id:"micfrontend/README",title:"webpack",description:"\u672c\u8d28\u4e0a,webpack \u662f\u4e00\u4e2a\u73b0\u4ee3 JavaScript \u5e94\u7528\u7a0b\u5e8f\u7684\u9759\u6001\u6a21\u5757\u6253\u5305\u5668(module bundler)\u3002 \u5f53 webpack \u5904\u7406\u5e94\u7528\u7a0b\u5e8f\u65f6,\u5b83\u4f1a\u9012\u5f52\u5730\u6784\u5efa\u4e00\u4e2a\u4f9d\u8d56\u5173\u7cfb\u56fe(dependency graph),\u5176\u4e2d\u5305\u542b\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u7684\u6bcf\u4e2a\u6a21\u5757,\u7136\u540e\u5c06\u6240\u6709\u8fd9\u4e9b\u6a21\u5757\u6253\u5305\u6210\u4e00\u4e2a\u6216\u591a\u4e2a bundle\u3002",source:"@site/docs/micfrontend/README.md",sourceDirName:"micfrontend",slug:"/micfrontend/",permalink:"/docs/micfrontend/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"micfrontend",permalink:"/docs/category/micfrontend"},next:{title:"design",permalink:"/docs/micfrontend/design/"}},c={},p=[{value:"Entry -- \u5165\u53e3\u8d77\u70b9(entry point)",id:"entry----\u5165\u53e3\u8d77\u70b9entry-point",level:2},{value:"Output -- \u6587\u4ef6\u8f93\u51fa",id:"output----\u6587\u4ef6\u8f93\u51fa",level:2},{value:"Module -- \u6a21\u5757",id:"module----\u6a21\u5757",level:2},{value:"Chunk -- \u4ee3\u7801\u5757",id:"chunk----\u4ee3\u7801\u5757",level:2},{value:"Loader -- \u8f6c\u6362\u5668",id:"loader----\u8f6c\u6362\u5668",level:2},{value:"Plugin -- \u63d2\u4ef6",id:"plugin----\u63d2\u4ef6",level:2},{value:"\u624b\u64b8 webpack",id:"\u624b\u64b8-webpack",level:2},{value:"\u901a\u8fc7 bundle \u5b9e\u4f8b\uff0c\u8bfb\u61c2\u4ee3\u7801",id:"\u901a\u8fc7-bundle-\u5b9e\u4f8b\u8bfb\u61c2\u4ee3\u7801",level:2}],u={toc:p},s="wrapper";function d(e){let{components:n,...t}=e;return(0,o.kt)(s,(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"webpack"},"webpack"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u672c\u8d28\u4e0a,webpack \u662f\u4e00\u4e2a\u73b0\u4ee3 JavaScript \u5e94\u7528\u7a0b\u5e8f\u7684\u9759\u6001\u6a21\u5757\u6253\u5305\u5668(module bundler)\u3002 \u5f53 webpack \u5904\u7406\u5e94\u7528\u7a0b\u5e8f\u65f6,\u5b83\u4f1a\u9012\u5f52\u5730\u6784\u5efa\u4e00\u4e2a\u4f9d\u8d56\u5173\u7cfb\u56fe(dependency graph),\u5176\u4e2d\u5305\u542b\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u7684\u6bcf\u4e2a\u6a21\u5757,\u7136\u540e\u5c06\u6240\u6709\u8fd9\u4e9b\u6a21\u5757\u6253\u5305\u6210\u4e00\u4e2a\u6216\u591a\u4e2a bundle\u3002")),(0,o.kt)("p",null,"webpack \u5c31\u50cf\u4e00\u6761\u751f\u4ea7\u7ebf,\u8981\u7ecf\u8fc7\u4e00\u7cfb\u5217\u5904\u7406\u6d41\u7a0b\u540e\u624d\u80fd\u5c06\u6e90\u6587\u4ef6\u8f6c\u6362\u6210\u8f93\u51fa\u7ed3\u679c\u3002 \u8fd9\u6761\u751f\u4ea7\u7ebf\u4e0a\u7684\u6bcf\u4e2a\u5904\u7406\u6d41\u7a0b\u7684\u804c\u8d23\u90fd\u662f\u5355\u4e00\u7684,\u591a\u4e2a\u6d41\u7a0b\u4e4b\u95f4\u6709\u5b58\u5728\u4f9d\u8d56\u5173\u7cfb,\u53ea\u6709\u5b8c\u6210\u5f53\u524d\u5904\u7406\u540e\u624d\u80fd\u4ea4\u7ed9\u4e0b\u4e00\u4e2a\u6d41\u7a0b\u53bb\u5904\u7406\u3002 \u63d2\u4ef6\u5c31\u50cf\u662f\u4e00\u4e2a\u63d2\u5165\u5230\u751f\u4ea7\u7ebf\u4e2d\u7684\u4e00\u4e2a\u529f\u80fd,\u5728\u7279\u5b9a\u7684\u65f6\u673a\u5bf9\u751f\u4ea7\u7ebf\u4e0a\u7684\u8d44\u6e90\u505a\u5904\u7406\u3002webpack \u901a\u8fc7 Tapable \u6765\u7ec4\u7ec7\u8fd9\u6761\u590d\u6742\u7684\u751f\u4ea7\u7ebf\u3002 > > webpack \u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u5e7f\u64ad\u4e8b\u4ef6,\u63d2\u4ef6\u53ea\u9700\u8981\u76d1\u542c\u5b83\u6240\u5173\u5fc3\u7684\u4e8b\u4ef6,\u5c31\u80fd\u52a0\u5165\u5230\u8fd9\u6761\u751f\u4ea7\u7ebf\u4e2d,\u53bb\u6539\u53d8\u751f\u4ea7\u7ebf\u7684\u8fd0\u4f5c\u3002 webpack \u7684\u4e8b\u4ef6\u6d41\u673a\u5236\u4fdd\u8bc1\u4e86\u63d2\u4ef6\u7684\u6709\u5e8f\u6027,\u4f7f\u5f97\u6574\u4e2a\u7cfb\u7edf\u6269\u5c55\u6027\u5f88\u597d\u3002 ---- \u6df1\u5165\u6d45\u51fa webpack \u5434\u6d69\u9e9f"),(0,o.kt)("h1",{id:"webpack-\u6838\u5fc3\u6982\u5ff5"},"webpack \u6838\u5fc3\u6982\u5ff5"),(0,o.kt)("h2",{id:"entry----\u5165\u53e3\u8d77\u70b9entry-point"},"Entry -- \u5165\u53e3\u8d77\u70b9(entry point)"),(0,o.kt)("p",null,"\u6307\u793a webpack \u5e94\u8be5\u4f7f\u7528\u54ea\u4e2a\u6a21\u5757\uff0c\u6765\u4f5c\u4e3a\u6784\u5efa\u5176\u5185\u90e8\u4f9d\u8d56\u56fe\u7684\u5f00\u59cb\u3002"),(0,o.kt)("p",null,"\u8fdb\u5165\u5165\u53e3\u8d77\u70b9\u540e\uff0cwebpack \u4f1a\u627e\u51fa\u6709\u54ea\u4e9b\u6a21\u5757\u548c\u5e93\u662f\u5165\u53e3\u70b9 (\u76f4\u63a5\u548c\u95f4\u63a5) \u4f9d\u8d56\u3002"),(0,o.kt)("p",null,"\u6bcf\u4e2a\u4f9d\u8d56\u9879\u968f\u5373\u88ab\u5904\u7406\uff0c\u6700\u540e\u8f93\u51fa\u5230 bundles \u7684\u6587\u4ef6\u4e2d\u3002"),(0,o.kt)("h2",{id:"output----\u6587\u4ef6\u8f93\u51fa"},"Output -- \u6587\u4ef6\u8f93\u51fa"),(0,o.kt)("p",null,"output \u5c5e\u6027\u544a\u8bc9 webpack \u518d\u54ea\u91cc\u8f93\u51fa\u5b83\u521b\u5efa\u7684 bundles\uff0c\u4ee5\u53ca\u5982\u4f55\u547d\u540d\u8fd9\u4e9b\u6587\u4ef6\uff0c\u9ed8\u8ba4\u503c\u4e3a ./dist\u3002"),(0,o.kt)("h2",{id:"module----\u6a21\u5757"},"Module -- \u6a21\u5757"),(0,o.kt)("p",null,"\u5728 webpack \u91cc\u4e00\u5207\u7686\u6a21\u5757\uff0c\u4e00\u4e2a\u6a21\u5757\u5bf9\u5e94\u7740\u4e00\u4e2a\u6587\u4ef6\u3002webpack \u4f1a\u4ece\u914d\u7f6e\u7684 entry \u5f00\u59cb\u9012\u5f52\u627e\u51fa\u6240\u6709\u4f9d\u8d56\u7684\u6a21\u5757\u3002"),(0,o.kt)("h2",{id:"chunk----\u4ee3\u7801\u5757"},"Chunk -- \u4ee3\u7801\u5757"),(0,o.kt)("p",null,"\u4e00\u4e2a chunk \u7531\u591a\u4e2a\u6a21\u5757\u7ec4\u5408\u800c\u6210\uff0c\u7528\u4e8e\u4ee3\u7801\u5408\u5e76\u548c\u5206\u9694\u3002"),(0,o.kt)("h2",{id:"loader----\u8f6c\u6362\u5668"},"Loader -- \u8f6c\u6362\u5668"),(0,o.kt)("p",null,"loader \u8ba9 webpack \u80fd\u591f\u53bb\u5904\u7406\u975e javaScript \u6587\u4ef6(webpack \u81ea\u8eab\u503c\u80fd\u7406\u89e3 javaScript)\u3002"),(0,o.kt)("p",null,"loader \u53ef\u4ee5\u5c06\u6240\u6709\u7c7b\u578b\u7684\u6587\u4ef6\u8f6c\u6362\u4e3a webpack \u53ef\u4ee5\u5904\u7406\u7684\u6709\u6548\u6a21\u5757\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5229\u7528 webpack \u7684\u6253\u5305\u80fd\u529b\uff0c\u5bf9\u5b83\u4eec\u8fdb\u884c\u5904\u7406\u3002"),(0,o.kt)("p",null,"\u672c\u8d28\u4e0a, webpack loader \u5c06\u6240\u6709\u7c7b\u578b\u7684\u6587\u4ef6\uff0c\u8f6c\u6362\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7684\u4f9d\u8d56\u56fe(\u548c\u6700\u7ec8\u7684 bundle) \u53ef\u4ee5\u76f4\u63a5\u5f15\u7528\u7684\u6a21\u5757\u3002"),(0,o.kt)("h2",{id:"plugin----\u63d2\u4ef6"},"Plugin -- \u63d2\u4ef6"),(0,o.kt)("p",null,"loader \u88ab\u7528\u4e8e\u8f6c\u6362\u9ed8\u5199\u7c7b\u578b\u7684\u6a21\u5757\uff0c\u800c\u63d2\u4ef6\u53ef\u4ee5\u7528\u4e8e\u6267\u884c\u8303\u56f4\u66f4\u5e7f\u7684\u4efb\u52a1\u3002"),(0,o.kt)("p",null,"\u63d2\u4ef6\u7684\u8303\u56f4\u5305\u62ec\uff0c\u4ece\u6253\u5305\u4f18\u5316\u5230\u538b\u7f29\uff0c\u4e00\u76f4\u5230\u91cd\u65b0\u5b9a\u4e49\u73af\u5883\u4e2d\u7684\u53d8\u91cf\u3002\u63d2\u4ef6\u63a5\u53e3\u529f\u80fd\u6781\u5176\u5f3a\u5927\uff0c\u53ef\u4ee5\u7528\u6765\u5904\u7406\u5404\u79cd\u5404\u6837\u7684\u4efb\u52a1\u3002"),(0,o.kt)("h1",{id:"webpack-\u6784\u5efa\u6d41\u7a0b"},"webpack \u6784\u5efa\u6d41\u7a0b"),(0,o.kt)("p",null,"Webpack \u7684\u8fd0\u884c\u6d41\u7a0b\u662f\u4e00\u4e2a\u4e32\u884c\u7684\u8fc7\u7a0b,\u4ece\u542f\u52a8\u5230\u7ed3\u675f\u4f1a\u4f9d\u6b21\u6267\u884c\u4ee5\u4e0b\u6d41\u7a0b :"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u521d\u59cb\u5316\u53c2\u6570\uff1a\u4ece\u914d\u7f6e\u6587\u4ef6\u548c Shell \u8bed\u53e5\u4e2d\u8bfb\u53d6\u4e0e\u5408\u5e76\u53c2\u6570,\u5f97\u51fa\u6700\u7ec8\u7684\u53c2\u6570\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u5f00\u59cb\u7f16\u8bd1\uff1a\u7528\u4e0a\u4e00\u6b65\u5f97\u5230\u7684\u53c2\u6570\u521d\u59cb\u5316 Compiler \u5bf9\u8c61,\u52a0\u8f7d\u6240\u6709\u914d\u7f6e\u7684\u63d2\u4ef6,\u6267\u884c\u5bf9\u8c61\u7684 run \u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u7f16\u8bd1\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u786e\u5b9a\u5165\u53e3\uff1a\u6839\u636e\u914d\u7f6e\u4e2d\u7684 entry \u627e\u51fa\u6240\u6709\u7684\u5165\u53e3\u6587\u4ef6\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u7f16\u8bd1\u6a21\u5757\uff1a\u4ece\u5165\u53e3\u6587\u4ef6\u51fa\u53d1,\u8c03\u7528\u6240\u6709\u914d\u7f6e\u7684 Loader \u5bf9\u6a21\u5757\u8fdb\u884c\u7ffb\u8bd1,\u518d\u627e\u51fa\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u6a21\u5757,\u518d\u9012\u5f52\u672c\u6b65\u9aa4\u76f4\u5230\u6240\u6709\u5165\u53e3\u4f9d\u8d56\u7684\u6587\u4ef6\u90fd\u7ecf\u8fc7\u4e86\u672c\u6b65\u9aa4\u7684\u5904\u7406\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u5b8c\u6210\u6a21\u5757\u7f16\u8bd1\uff1a\u5728\u7ecf\u8fc7\u7b2c 4 \u6b65\u4f7f\u7528 Loader \u7ffb\u8bd1\u5b8c\u6240\u6709\u6a21\u5757\u540e,\u5f97\u5230\u4e86\u6bcf\u4e2a\u6a21\u5757\u88ab\u7ffb\u8bd1\u540e\u7684\u6700\u7ec8\u5185\u5bb9\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u8f93\u51fa\u8d44\u6e90\uff1a\u6839\u636e\u5165\u53e3\u548c\u6a21\u5757\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb,\u7ec4\u88c5\u6210\u4e00\u4e2a\u4e2a\u5305\u542b\u591a\u4e2a\u6a21\u5757\u7684 Chunk,\u518d\u628a\u6bcf\u4e2a Chunk \u8f6c\u6362\u6210\u4e00\u4e2a\u5355\u72ec\u7684\u6587\u4ef6\u52a0\u5165\u5230\u8f93\u51fa\u5217\u8868,\u8fd9\u6b65\u662f\u53ef\u4ee5\u4fee\u6539\u8f93\u51fa\u5185\u5bb9\u7684\u6700\u540e\u673a\u4f1a\u3002"),(0,o.kt)("li",{parentName:"ol"},"\u8f93\u51fa\u5b8c\u6210\uff1a\u5728\u786e\u5b9a\u597d\u8f93\u51fa\u5185\u5bb9\u540e,\u6839\u636e\u914d\u7f6e\u786e\u5b9a\u8f93\u51fa\u7684\u8def\u5f84\u548c\u6587\u4ef6\u540d,\u628a\u6587\u4ef6\u5185\u5bb9\u5199\u5165\u5230\u6587\u4ef6\u7cfb\u7edf\u3002")),(0,o.kt)("h2",{id:"\u624b\u64b8-webpack"},"\u624b\u64b8 webpack"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"const fs = require('fs'); // \u5f15\u5165node\u6587\u4ef6\u6a21\u5757\nconst path = require('path');\nconst parser = require('@babel/parser'); // \u5c06\u6587\u4ef6\u5185\u5bb9\u8f6c\u4e3aAST\u62bd\u8c61\u8bed\u6cd5\u6811\nconst options = require('./webpack.config');\nconst traverse = require('@babel/traverse').default;\nconst { transformFromAst } = require('@babel/core');\n\nconst Parser = {\n  // \u8f6c\u6362ast\u62bd\u8c61\u8bed\u6cd5\u6811\n  getAst: (path) => {\n    //\xa0\u8bfb\u53d6\u5165\u53e3\u6587\u4ef6\n    const content = fs.readFileSync(path, 'utf-8'); //\xa0\u5c06\u6587\u4ef6\u5185\u5bb9\u8f6c\u4e3aAST\u62bd\u8c61\u8bed\u6cd5\u6811\n    return parser.parse(content, { sourceType: 'module' });\n  },\n  // \u751f\u6210\u4f9d\u8d56\u5173\u7cfb\n  getDependencies: (ast, filename) => {\n    const dependencies = {};\n    //\xa0\u904d\u5386\u6240\u6709\u7684\xa0import\xa0\u6a21\u5757,\u5b58\u5165dependencies\n    traverse(ast, {\n      //\xa0\u7c7b\u578b\u4e3a\xa0ImportDeclaration\xa0\u7684\xa0AST\xa0\u8282\u70b9\xa0(\u5373\u4e3aimport\xa0\u8bed\u53e5)\n      ImportDeclaration({ node }) {\n        const dirname = path.dirname(filename);\n        //\xa0\u4fdd\u5b58\u4f9d\u8d56\u6a21\u5757\u8def\u5f84,\u4e4b\u540e\u751f\u6210\u4f9d\u8d56\u5173\u7cfb\u56fe\u9700\u8981\u7528\u5230\n        const filepath = './' + path.join(dirname, node.source.value);\n        dependencies[node.source.value] = filepath;\n      }\n    });\n    return dependencies;\n  },\n  //\xa0AST\u8f6c\u6362\u4e3acode\n  getCode: (ast) => {\n    const { code } = transformFromAst(ast, null, {\n      presets: ['@babel/preset-env']\n    });\n    return code;\n  }\n};\n\nclass Compiler {\n  constructor(options) {\n    //\xa0webpack\xa0\u914d\u7f6e\n    const { entry, output } = options;\n    this.entry = entry; //\xa0\u5165\u53e3\n    this.output = output; //\xa0\u51fa\u53e3\n    this.modules = []; //\xa0\u6a21\u5757\n  }\n\n  //\xa0\u6784\u5efa\u542f\u52a8\n  run() {\n    //\xa0\u89e3\u6790\u5165\u53e3\u6587\u4ef6\n    const info = this.build(this.entry);\n    this.modules.push(info);\n    for (let index = 0; index < this.modules.length; index++) {\n      //\xa0\u5224\u65ad\u6709\u4f9d\u8d56\u5bf9\u8c61,\u9012\u5f52\u89e3\u6790\u6240\u6709\u4f9d\u8d56\u9879\n      console.log(this.modules);\n      const dependencies = this.modules[index].dependencies;\n      if (dependencies) {\n        for (const dependency in dependencies) {\n          this.modules.push(this.build(dependencies[dependency]));\n        }\n      }\n    }\n    //\xa0\u751f\u6210\u4f9d\u8d56\u5173\u7cfb\u56fe\n    const dependencyGraph = this.modules.reduce(\n      (graph, item) => ({\n        ...graph,\n        //\xa0\u4f7f\u7528\u6587\u4ef6\u8def\u5f84\u4f5c\u4e3a\u6bcf\u4e2a\u6a21\u5757\u7684\u552f\u4e00\u6807\u8bc6\u7b26,\u4fdd\u5b58\u5bf9\u5e94\u6a21\u5757\u7684\u4f9d\u8d56\u5bf9\u8c61\u548c\u6587\u4ef6\u5185\u5bb9\n        [item.filename]: { dependencies: item.dependencies, code: item.code }\n      }),\n      {}\n    );\n    this.generate(dependencyGraph);\n  }\n  // \u8fd4\u56de\u6a21\u5757\u4fe1\u606f\n  build(filename) {\n    const { getAst, getDependencies, getCode } = Parser;\n    const ast = getAst(filename);\n    const dependencies = getDependencies(ast, filename);\n    const code = getCode(ast);\n    return {\n      //\xa0\u6587\u4ef6\u8def\u5f84,\u53ef\u4ee5\u4f5c\u4e3a\u6bcf\u4e2a\u6a21\u5757\u7684\u552f\u4e00\u6807\u8bc6\u7b26\n      filename,\n      //\xa0\u4f9d\u8d56\u5bf9\u8c61,\u4fdd\u5b58\u7740\u4f9d\u8d56\u6a21\u5757\u8def\u5f84\n      dependencies: dependencies,\n      //\xa0\u6587\u4ef6\u5185\u5bb9\n      code\n    };\n  }\n  //\xa0\u91cd\u5199\xa0require\u51fd\u6570,\u8f93\u51fabundle\n  generate(code) {\n    //\xa0\u8f93\u51fa\u6587\u4ef6\u8def\u5f84\n    const filePath = path.join(this.output.path, this.output.filename);\n    const bundle = `(function(graph){\xa0\xa0\xa0\xa0\n                      function\xa0require(module){\xa0\xa0\xa0\xa0\xa0\xa0\xa0\n                        function\xa0localRequire(relativePath){\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\n                          return\xa0require(graph[module].dependencies[relativePath])\xa0\n                        }\xa0\xa0\xa0\xa0\xa0\xa0\n        \xa0\xa0              var\xa0exports\xa0=\xa0{};\xa0\xa0\xa0\xa0\n        \xa0\xa0\xa0\xa0            (function(require,exports,code){\xa0\xa0\xa0\xa0\xa0\xa0\xa0\n          \xa0\xa0              eval(code)\xa0\xa0\xa0\xa0\xa0\xa0\n        \xa0               })(localRequire,exports,graph[module].code);\xa0\xa0\xa0\n        \xa0\xa0\xa0\xa0\xa0           return\xa0exports;\xa0\n      \xa0\xa0\xa0\xa0\xa0           }\xa0\xa0\n        \xa0\xa0\xa0\xa0          require('${this.entry}')\xa0\xa0\n      \xa0\xa0            })(${JSON.stringify(code)})`;\n    //\xa0\u628a\u6587\u4ef6\u5185\u5bb9\u5199\u5165\u5230\u6587\u4ef6\u7cfb\u7edf\n    fs.writeFileSync(filePath, bundle, 'utf-8');\n  }\n}\n\nnew Compiler(options).run();\n")),(0,o.kt)("h2",{id:"\u901a\u8fc7-bundle-\u5b9e\u4f8b\u8bfb\u61c2\u4ee3\u7801"},"\u901a\u8fc7 bundle \u5b9e\u4f8b\uff0c\u8bfb\u61c2\u4ee3\u7801"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"//\xa0\u5b9a\u4e49\u4e00\u4e2a\u7acb\u5373\u6267\u884c\u51fd\u6570,\u4f20\u5165\u751f\u6210\u7684\u4f9d\u8d56\u5173\u7cfb\u56fe\n(function (graph) {\n  //\xa0\u91cd\u5199require\u51fd\u6570\n  function require(moduleId) {\n    //\xa0\u627e\u5230\u5bf9\u5e94moduleId\u7684\u4f9d\u8d56\u5bf9\u8c61,\u8c03\u7528require\u51fd\u6570,eval\u6267\u884c,\u62ff\u5230exports\u5bf9\u8c61\n    function localRequire(relativePath) {\n      return require(graph[moduleId].dependecies[relativePath]); //\xa0{__esModule:\xa0true,\xa0say:\xa0\u0192\xa0say(name)}\n    } //\xa0\u5b9a\u4e49exports\u5bf9\u8c61\n    var exports = {};\n    (function (require, exports, code) {\n      //\xa0commonjs\u8bed\u6cd5\u4f7f\u7528module.exports\u66b4\u9732\u5b9e\u73b0,\u6211\u4eec\u4f20\u5165\u7684exports\u5bf9\u8c61\u4f1a\u6355\u83b7\u4f9d\u8d56\u5bf9\u8c61(hello.js)\u66b4\u9732\u7684\u5b9e\u73b0(exports.say\xa0=\xa0say)\u5e76\u5199\u5165\n      eval(code);\n    })(localRequire, exports, graph[moduleId].code); //\xa0\u66b4\u9732exports\u5bf9\u8c61,\u5373\u66b4\u9732\u4f9d\u8d56\u5bf9\u8c61\u5bf9\u5e94\u7684\u5b9e\u73b0\n    return exports;\n  }\n  debugger;\n  //\xa0\u4ece\u5165\u53e3\u6587\u4ef6\u5f00\u59cb\u6267\u884c\n  require('./src/index.js');\n})({\n  './src/index.js': {\n    dependecies: { './hello.js': './src/hello.js' },\n    code:\n      '\"use\xa0strict\";\\n\\nvar\xa0_hello\xa0=\xa0require(\"./hello.js\");\\n\\ndocument.write((0,\xa0_hello.say)(\"webpack\"));'\n  },\n  './src/hello.js': {\n    dependecies: {},\n    code:\n      '\"use\xa0strict\";\\n\\nObject.defineProperty(exports,\xa0\"__esModule\",\xa0{\\n\xa0\xa0value:\xa0true\\n});\\nexports.say\xa0=\xa0say;\\n\\nfunction\xa0say(name)\xa0{\\n\xa0\xa0return\xa0\"hello\xa0\".concat(name);\\n}'\n  }\n});\n")),(0,o.kt)("h1",{id:"\u76f8\u5173\u94fe\u63a5"},"\u76f8\u5173\u94fe\u63a5"),(0,o.kt)("p",null,"\u539f\u6587\u94fe\u63a5\uff1a",(0,o.kt)("a",{parentName:"p",href:"https://juejin.cn/post/6844904038543130637?utm_source=gold_browser_extension?utm_source=gold_browser_extension"},"webpack\u6253\u5305\u539f\u7406 ? \u770b\u5b8c\u8fd9\u7bc7\u4f60\u5c31\u61c2\u4e86 !")),(0,o.kt)("p",null,"github:",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Zaoei/webpack-principle"},"\u4ee3\u7801\u5730\u5740")))}d.isMDXComponent=!0}}]);