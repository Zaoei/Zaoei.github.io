"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8270],{3905:(e,n,t)=>{t.d(n,{Zo:()=>i,kt:()=>m});var o=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=o.createContext({}),c=function(e){var n=o.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):u(u({},n),e)),t},i=function(e){var n=c(e.components);return o.createElement(p.Provider,{value:n},e.children)},k="mdxType",s={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},h=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,p=e.parentName,i=l(e,["components","mdxType","originalType","parentName"]),k=c(t),h=r,m=k["".concat(p,".").concat(h)]||k[h]||s[h]||a;return t?o.createElement(m,u(u({ref:n},i),{},{components:t})):o.createElement(m,u({ref:n},i))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,u=new Array(a);u[0]=h;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[k]="string"==typeof e?e:r,u[1]=l;for(var c=2;c<a;c++)u[c]=t[c];return o.createElement.apply(null,u)}return o.createElement.apply(null,t)}h.displayName="MDXCreateElement"},6309:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>u,default:()=>s,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var o=t(7462),r=(t(7294),t(3905));const a={},u="chunk",l={unversionedId:"webpack-resolve/Chunk",id:"webpack-resolve/Chunk",title:"chunk",description:"Compilation.seal() \u5f00\u59cb chunk \u9636\u6bb5",source:"@site/docs/webpack-resolve/Chunk.md",sourceDirName:"webpack-resolve",slug:"/webpack-resolve/Chunk",permalink:"/docs/webpack-resolve/Chunk",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"webpack-resolve",permalink:"/docs/category/webpack-resolve"},next:{title:"webpack-plugin",permalink:"/docs/webpack-resolve/Plugin"}},p={},c=[],i={toc:c},k="wrapper";function s(e){let{components:n,...a}=e;return(0,r.kt)(k,(0,o.Z)({},i,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"chunk"},"chunk"),(0,r.kt)("p",null,"Compilation.seal() \u5f00\u59cb chunk \u9636\u6bb5"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u901a\u8fc7\u5728 module parse \u9636\u6bb5\u5f97\u5230\u7684 moduleGraph \u4fe1\u606f\u521d\u59cb\u5316 ChunkGraph\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e\u5165\u53e3\u8fdb\u884c\u904d\u5386",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u6267\u884c addChunk \u65b9\u6cd5\uff0c\u6587\u4ef6\u540d\u521d\u59cb\u5316 chunk"),(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e\u5165\u53e3\u6587\u4ef6\u7684 option \u4e2d\u5f97\u5230 chunk \u76f8\u5173\u7684\u914d\u7f6e\u3002\u521d\u59cb\u5316\u4e00\u4e2a entrypoint\uff08chunkGroup\uff09"),(0,r.kt)("li",{parentName:"ol"},"\u904d\u5386 dependencies \u6a21\u5757\u4f9d\u8d56\u4fe1\u606f\u3002",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"entrypoint \u628a\u6a21\u5757\u540d\u79f0\uff08moduleId\uff09\u5b58\u5165 origin \u4e2d"),(0,r.kt)("li",{parentName:"ol"},"\u83b7\u53d6\u5230\u5165\u53e3 module \u7684\u8be6\u7ec6\u4fe1\u606f\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5efa\u7acb chunkGraph \u548c chunk \u548c module \u7684\u5173\u8054, chunkGroup \u548c chunk \u5efa\u7acb\u5173\u8054"))))),(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e\u5165\u53e3\u6587\u4ef6\u7684\u914d\u7f6e dependOn\uff08\u5f53\u524d\u5165\u53e3\u6240\u4f9d\u8d56\u7684\u5165\u53e3\u3002\u5b83\u4eec\u5fc5\u987b\u5728\u8be5\u5165\u53e3\u88ab\u52a0\u8f7d\u524d\u88ab\u52a0\u8f7d\uff09 \u548c runtime\uff08\u8fd0\u884c\u65f6 chunk \u7684\u540d\u5b57\uff09 \u8fdb\u884c\u5904\u7406\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u6267\u884c buildChunkGraph \uff0c\u5f00\u59cb\u5bf9 chunk \u8fdb\u884c\u5904\u7406\u3002",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"SHARED STATE"),(0,r.kt)("li",{parentName:"ol"},"PART ONE \u9636\u6bb5 visitModules",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e entrypoint\uff08chunkGroup\uff09 \u521b\u5efa chunkGroupInfo"),(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e entrypoint\uff08chunkGroup\uff09\u4e2d\u7684 module \u5217\u8868\uff0c\u521b\u5efa queue \u961f\u5217"),(0,r.kt)("li",{parentName:"ol"},"chunkGroupInfoMap.set(chunkGroup, chunkGroupInfo);"),(0,r.kt)("li",{parentName:"ol"},"\u56e0\u4e3a\u5728\u8bfb\u53d6 queue \u961f\u5217\u65f6\u4f7f\u7528 pop() \u8bfb\u53d6\u6700\u540e\u4e00\u4e2a\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u8981\u53cd\u8f6c queue.reverse() \u961f\u5217\uff0c\u4fdd\u6301\u6b63\u786e\u7684\u987a\u5e8f"),(0,r.kt)("li",{parentName:"ol"},"\u9012\u5f52 queue\u3002",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u6267\u884c processQueue \u65b9\u6cd5\uff0c\u6839\u636e queueItem.action \u8fdb\u884c\u5224\u65ad\u3002",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"ADD_AND_ENTER_MODULE = 1\u3002\u5224\u65ad module \u548c chunk \u662f\u5426\u5efa\u7acb\u8fc7\u8054\u7cfb\uff0c\u5982\u679c\u6709 break\u3002\u5982\u679c\u6ca1\u6709\u5219\u5efa\u7acb module \u548c chunk \u7684\u5173\u7cfb\u3002\u7ee7\u7eed\u6267\u884c ENTER_MODULE"),(0,r.kt)("li",{parentName:"ol"},"ENTER_MODULE = 2\u3002",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"*","\u5224\u65ad module \u5728\u5f53\u524d chunkGroup \u662f\u5426\u662f\u9996\u6b21\u52a0\u8f7d\uff0c\u8bb0\u5f55\u5f53\u524d chunkGroup \u5b58\u5728\u7684\u9996\u6b21\u52a0\u8f7d\u6a21\u5757\u4e2a\u6570\u3002"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("em",{parentName:"li"},"\u8bb0\u5f55\u5f53\u524d\u6a21\u5757\u7684\u52a0\u8f7d\u7d22\u5f15\uff0c\u5373\u52a0\u8f7d\u987a\u5e8f\uff0c\u5982\u679c\u5df2\u7ecf\u6709\u7d22\u5f15\uff0c\u4ee3\u8868\u5df2\u7ecf\u52a0\u8f7d\u8fc7\u4e86\u3002")),(0,r.kt)("li",{parentName:"ol"},"\u628a action \u8bbe\u7f6e\u4e3a LEAVE_MODULE\u3002 \u5e76\u628a\u5f53\u524d queueItem\uff0c\u5728\u4e00\u6b21\u538b\u5165 queueItem \u4e2d\u3002\u7531\u4e8e queue.pop() \u53d6\u7684\u6700\u540e\u4e00\u4f4d\uff0c\u76f8\u5f53\u4e8e\u6267\u884c\u5b8c\u8fd9\u6b21\u7684 processQueue \u65b9\u6cd5\u3002\u7acb\u5373\u5728\u6267\u884c\u4e00\u6b21\u3002\u6ca1\u6709 break \uff0c\u7ee7\u7eed\u6267\u884c action = PROCESS_BLOCK \u7684\u903b\u8f91\u3002"))),(0,r.kt)("li",{parentName:"ol"},"PROCESS_BLOCK = 3\u3002\u6267\u884c processBlock \u65b9\u6cd5\u3002",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e\u5f53\u524d module \u5728 moduleGraph \u4e2d\u67e5\u627e\u5f53\u524d\u6a21\u5757\u7684\u4f9d\u8d56\u6a21\u5757\uff0c\u5b58\u5165 blockModules \u4e2d\u3002\u5982\u679c\u662f\u5f02\u6b65\u6a21\u5757\uff0c\u4f1a\u8f6c\u5316\u6210\u666e\u901a\u6a21\u5757\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u904d\u5386 blockModules ,\u6839\u636e module \u5efa\u7acb queueBuffer\u3002\u5176\u5b9e\u5c31\u662f queueItem \u96c6\u5408\u3002\u518d\u628a queueBuffer \u6309\u7167\u5012\u53d9\u4e00\u4e2a\u4e2a\u6dfb\u52a0\u8fdb queue \u4e2d\u3002\u5230\u8fd9\u5b8c\u6210\u4e86\u540c\u6b65\u6a21\u5757\u7684\u65b0\u589e\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u63a5\u4e0b\u6765\u5224\u65ad\u662f\u5426\u5b58\u5728\u5f02\u6b65\u6a21\u5757\u3002\u5982\u679c\u5b58\u5728\u904d\u5386 block.blocks\uff08\u5f02\u6b65\u6a21\u5757\u6570\u636e\uff09\u3002 block \u5c31\u662f module\u3002block.blocks \u5c31\u662f module \u7684\u5f02\u6b65\u6a21\u5757\u6570\u636e\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u751f\u6210\u4e00\u4e2a\u65b0\u7684 chunkGroup\u3001chunkGroupInfo\uff0c\u751f\u6210\u65b0\u7684 chunk"),(0,r.kt)("li",{parentName:"ol"},"\u8bb0\u5f55\u5230 blockConnections \u4e2d\u3002\u7b2c\u4e8c\u6b65\u8fdb\u884c\u5757\u548c\u7ec4\uff0c\u4ee5\u53ca\u7ec4\u548c\u7ec4\u4e4b\u95f4\u7684\u8fde\u63a5\u5c31\u901a\u8fc7\u8fd9\u4e2a\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5efa\u7acb\u8fde\u63a5\u5173\u7cfb\u3002\u5728\u7b2c\u4e8c\u6b65\u8fdb\u884c\u8fde\u63a5\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u628a\u5f53\u524d module \u7684 chunkGroupInfo \u548c\u5f02\u6b65\u6a21\u5757 chunkGroupInfo \u4fe1\u606f\u5b58\u5165\u4e00\u4e2a\u516c\u5171 queueConnect \u4e2d\uff0c\u4e3a\u63a5\u4e0b\u6765\u7684\u7ec4\u4e0e\u7ec4\u7684\u5173\u8054\u505a\u51c6\u5907\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e\u5efa\u597d\u7684\u5f02\u6b65\u6a21\u5757 chunkGroup \u7b49\u4fe1\u606f\u3002\u538b\u5165 queueDelayed \u961f\u5217\u4e2d\uff0c\u7b49\u540c\u6b65\u961f\u5217\u6267\u884c\u5b8c\u6bd5\u4e86\uff0c\u5728\u6267\u884c\u8fd9\u4e2a\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u628a\u5b58\u5728\u5f02\u6b65\u6a21\u5757\u7684\u6a21\u5757\u3002\u5b58\u5165 blocksWithNestedBlocks \u603b\uff0c\u731c\u6d4b\u540e\u7eed hmr \u7b49\u80fd\u7528\u4e0a\u3002"),(0,r.kt)("li",{parentName:"ol"},"break \u7ed3\u675f\u3002"))),(0,r.kt)("li",{parentName:"ol"},"LEAVE_MODULE = 5\u3002\u91cd\u65b0\u6267\u884c ENTER_MODULE \u4e2d\u538b\u5165\u961f\u5217\u7684 module\u3002",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u5224\u65ad module \u5728\u5f53\u524d chunkGroup \u662f\u5426\u662f\u6700\u540e\u4e00\u6b21\u52a0\u8f7d\uff0c\u8bb0\u5f55\u5f53\u524d chunkGroup \u4e2d\u6a21\u5757\u52a0\u8f7d\u6570\u91cf\u3002"))))))),(0,r.kt)("li",{parentName:"ol"},"\u5982\u679c\u5b58\u5728\u5f02\u6b65\u6a21\u5757\u5219\u6267\u884c processConnectQueue\u3002",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e queueConnect \u8fdb\u884c\u904d\u5386\uff0c\u628a\u5173\u7cfb\u4fe1\u606f\u8f6c\u5316\u6210 children \u6570\u7ec4\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u8ba1\u7b97\u53ef\u7528\u6a21\u5757"),(0,r.kt)("li",{parentName:"ol"},"\u66f4\u65b0 chunkGroup \u7684\u4fe1\u606f"),(0,r.kt)("li",{parentName:"ol"},"\u6e05\u9664 queueConnect"),(0,r.kt)("li",{parentName:"ol"},"\u6267\u884c processchunkGroupForCombining\uff0c\u8ba1\u7b97\u53ef\u7528\u6a21\u5757"),(0,r.kt)("li",{parentName:"ol"},"\u6267\u884c processConnectQueue\uff0cprocesschunkGroupForMerging\uff0c\u8ba1\u7b97\u6700\u5c0f\u53ef\u7528\u6a21\u5757"))),(0,r.kt)("li",{parentName:"ol"},"\u5f53\u6240\u6709\u540c\u6b65\u6a21\u5757\u5904\u7406\u5b8c\u4e4b\u540e\uff0c\u5728\u8fdb\u884c\u5904\u7406\u5f02\u6b65\u6a21\u5757"))),(0,r.kt)("li",{parentName:"ol"},"PART TWO \u9636\u6bb5 connectchunkGroup \u521b\u5efa\u5b8c\u6574\u7684 chunkGraph",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u68c0\u67e5\u662f\u5426\u9700\u8981\u8fde\u63a5"),(0,r.kt)("li",{parentName:"ol"},"\u5efa\u7acb\u5f02\u6b65\u6a21\u5757 \u4e0e chunkGroup \u4e4b\u95f4\u7684\u8054\u7cfb"),(0,r.kt)("li",{parentName:"ol"},"\u5efa\u7acb chunkGroup \u548c chunkGroup \u4e4b\u95f4\u7684\u8054\u7cfb"))),(0,r.kt)("li",{parentName:"ol"},"\u904d\u5386 chunkGroupInfoMap\uff0c \u4e3a chunk \u52a0\u4e0a\u516c\u5171\u7684 runtime \u6a21\u5757"),(0,r.kt)("li",{parentName:"ol"},"Cleanup work \u9636\u6bb5 cleanupUnconnectedGroups \u6e05\u9664\u65e0\u7528\u7684\u8fde\u63a5")))),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"this.hooks.beforeChunks.call();")),(0,r.kt)("p",null,"4\u3001\u904d\u5386\u6211\u4eec\u5728 module parse \u9636\u6bb5\u5f97\u5230\u7684 dependencies \u4f9d\u8d56\u96c6\u5408\u3002\n4.1\u3001\u7528\u6a21\u5757\u540d\uff08\u4e00\u822c\u5c31\u662f moduleId\uff09,\u5b58\u5165 chunkGroup \u4e2d\u3002\n4.2"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"this.hooks.beforeChunks.call();\nfor (const preparedEntrypoint of this._preparedEntrypoints) {\n    // \u521d\u59cb\u5316\u76f8\u5173\u6570\u636e\n    const module = preparedEntrypoint.module;\n    const name = preparedEntrypoint.name;\n    const chunk = this.addChunk(name); // \u67e5\u627e\u7f13\u5b58\uff0c\u6ca1\u6709\u5219\u65b0\u5efa\n    const entrypoint = new Entrypoint(name);\n    entrypoint.setRuntimeChunk(chunk);\n    entrypoint.addOrigin(null, name, preparedEntrypoint.request);\n\n    // \u8ddf compilation \u8fdb\u884c\u5173\u8054\n    this.namedchunkGroup.set(name, entrypoint);\n    this.entrypoints.set(name, entrypoint);\n    this.chunkGroup.push(entrypoint);\n\n    // chunk\u3001chunkGroup\u548cmodule \u4e92\u76f8\u5173\u8054\n    GraphHelpers.connectChunkGroupAndChunk(entrypoint, chunk);\n    GraphHelpers.connectChunkAndModule(chunk, module);\n\n    chunk.entryModule = module;\n    chunk.name = name;\n\n    this.assignDepth(module); // \u83b7\u53d6\u6a21\u5757\u4f9d\u8d56\u7684\u6df1\u5ea6\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"/**\n * This method creates the Chunk graph from the Module graph\n * @param {Compilation} compilation the compilation\n * @param {Entrypoint[]} inputchunkGroup chunk groups which are processed\n * @returns {void}\n */\nconst buildChunkGraph = (compilation, inputchunkGroup) => {\n    // SHARED STATE\n\n    /** @type {Map<AsyncDependenciesBlock, BlockChunkGroupConnection[]>} */\n    const blockConnections = new Map();\n\n    /** @type {Set<ChunkGroup>} */\n    const allCreatedchunkGroup = new Set();\n\n    /** @type {Map<ChunkGroup, ChunkGroupInfo>} */\n    const chunkGroupInfoMap = new Map();\n\n    /** @type {Set<DependenciesBlock>} */\n    const blocksWithNestedBlocks = new Set();\n\n    // PART ONE\n    // \u4ece\u5165\u53e3chunk\u5f00\u59cb\uff0c\u521b\u5efa chunk\u3001module\u548cchunkGroup \u7684\u5173\u7cfb\n\n    visitModules(\n        compilation,\n        inputchunkGroup,\n        chunkGroupInfoMap,\n        blockConnections,\n        blocksWithNestedBlocks,\n        allCreatedchunkGroup\n    );\n\n    // PART TWO\n\n    connectchunkGroup(blocksWithNestedBlocks, blockConnections, chunkGroupInfoMap);\n\n    // Cleaup work\n\n    cleanupUnconnectedGroups(compilation, allCreatedchunkGroup);\n};\n\nmodule.exports = buildChunkGraph;\n")),(0,r.kt)("p",null,"\u7b2c\u4e00\u9636\u6bb5\uff1a"),(0,r.kt)("p",null,"1\u3001\u6839\u636e module \u7684\u4f9d\u8d56\u9879 dependencies(\u540c\u6b65\u4f9d\u8d56)\uff0c blocks\uff08\u5f02\u6b65\u4f9d\u8d56\uff09\u8fdb\u884c\u904d\u5386\uff0c\u751f\u6210 blockInfoMap \u7684\u6570\u636e\u7ed3\u6784\u3002"),(0,r.kt)("p",null,"2\u3001"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"switch(){\n        case ADD_AND_ENTER_MODULE: {\n        // \u5224\u65ad\u5f53\u524d\u6a21\u5757\u662f\u5426\u5728\u6700\u5c0f\u53ef\u7528\u6a21\u5757\u6570\u7ec4\u5185\uff0c\u5982\u679c\u5728\u8bf4\u660e\u8fd9\u4e2a\u6a21\u5757\u5df2\u7ecf\u5173\u8054\u8fc7\u4e86\uff0c\u628a\u8fd9\u4e2a\u6a21\u5757\u52a0\u5165  skippedItems \u8df3\u8fc7\u6570\u7ec4\u4e2d\u3002 \u5982\u679c\u4e0d\u5728\uff0c\u5efa\u7acb\u5f53\u524d chunk \u548c module \u7684\u5173\u8054\u3002\n      },\n        case ENTER_MODULE: {\n        // \u67e5\u627e\u6a21\u5757\u5185\u5bf9\u5e94 chunkGroup \u7684\u7d22\u5f15\uff0c\u5982\u679c\u6ca1\u6709\u8d4b\u503c\u4e00\u4e2a\u3002\n          // push \u8fdb\u961f\u5217\uff0c\u628a\u72b6\u6001\u8bbe\u7f6e\u4e3a LEAVE_MODULE\n      }\n        case PROCESS_BLOCK: {\n        // \u6839\u636e blockInfoMap.get(block)\uff0c \u627e\u5230\u5f53\u524d\u6a21\u5757\u7684\u540c\u6b65\u6a21\u5757\u548c\u5f02\u6b65\u6a21\u5757\uff0c\n          // \u628a\u540c\u6b65\u4f9d\u8d56\u4f9d\u6b21 push \u8fdb\u961f\u5217\uff0c\u628a\u72b6\u6001\u8bbe\u7f6e\u4e3a ADD_AND_ENTER_MODULE\n          // 1.\u904d\u5386\u5f02\u6b65\u4f9d\u8d56\n          // 1.1 \u521b\u5efa\u4e00\u4e2a\u5bf9\u5e94\u5f02\u6b65\u4f9d\u8d56\u7684 chunkGroup \u548c chunk\uff0c\u5e76\u5efa\u7acb\u4e24\u8005\u7684\u8054\u7cfb\n        // 1.2 \u521b\u5efa\u4e00\u4e2a chunkGroup \u548c\u65b0 chunkGroup \u76f4\u63a5\u7684\u8054\u7cfb ?\n          // 1.3 \u521b\u5efa\u4e00\u4e2a chunkGroup \u548c\u5f53\u524d chunkGroup \u96c6\u5408\u7684\u7684\u8054\u7cfb ?\n          // 1.4 \u628a\u5f02\u6b65\u4f9d\u8d56\u4f9d\u6b21 push \u8fdb\u5f02\u6b65\u961f\u5217\uff0c\u628a\u72b6\u6001\u8bbe\u7f6e\u4e3a PROCESS_BLOCK\n      }\n        case LEAVE_MODULE: {\n        // \u8bbe\u7f6e chunkGroup \u548c module \u7684 index2\n      }\n\n}\n\n")),(0,r.kt)("p",null,"3\u3001\u67e5\u627e\u53ef\u7528\u6a21\u5757\uff0c\u8bbe\u7f6e children \u548c resultingAvailableModules\u3002\n4\u3001\u5728\u6839\u636e target \u521d\u59cb\u5316\u65b0\u7684 chunkGroupInfo\uff0c\u5e76\u628a availableModulesToBeMerged \u8bbe\u7f6e\u4e0a\u53bb\u3002\n5\u3001\u5408\u5e76\u53ef\u7528\u6a21\u5757\uff0c\u5904\u7406 chunkGroup \u5185\u7684 minAvailableModules\u3001minAvailableModulesOwned\u3001availableModulesToBeMerged\u3002\n6\u3001\u5982\u679c\u5f53\u524d\u7684\u53ef\u7528\u6a21\u5757\u6709\u4fee\u6539\u5219 push \u8fdb\u961f\u5217\u4e2d\u3002\n7\u3001\u540c\u6b65\u961f\u5217\u6267\u884c\u5b8c\u6bd5\uff0c\u5224\u65ad\u662f\u5426\u5b58\u5728\u5f02\u6b65\u961f\u5217\uff0c\u5982\u679c\u6709\u628a\u5f02\u6b65\u961f\u5217 push \u8fdb\u540c\u6b65\u961f\u5217\u4e2d\u3002"),(0,r.kt)("p",null,"\u7b2c\u4e8c\u9636\u6bb5\uff1a\n\u6839\u636e\u7b2c\u4e00\u9636\u6bb5\u5efa\u7acb\u8d77\u7684 chunkGroup \u4e4b\u5bb6\u7684\u8054\u7cfb blockConnections\n1\u3001\u68c0\u67e5\u662f\u5426\u9700\u8981\u8fdb\u884c\u5173\u8054\n2\u3001\u904d\u5386\u8fde\u63a5\u5173\u7cfb\n3\u3001\u6839\u636e chunkGroup \u4e4b\u95f4\u7684\u76f8\u540c module \u8fdb\u884c\u5173\u8054\uff0c\u5efa\u7acb\u7236\u5b50\u5173\u7cfb"),(0,r.kt)("p",null,"\u7b2c\u4e09\u9636\u6bb5\uff1a\n\u6e05\u7406\u65e0\u7528\u7684 chunk\u3002\n\u901a\u8fc7\u5224\u65ad\u662f\u5426\u5b58\u5728\u7236\u7ea7\u5173\u8054\uff0c\u5982\u679c\u6ca1\u6709\u5219\u5220\u9664\u5bf9\u5e94 chunk"),(0,r.kt)("p",null,"\u81f3\u6b64 chunkGroup \u751f\u6210\u5b8c\u6bd5 "),(0,r.kt)("p",null,"\u6267\u884c afterChunk hooks\uff0c\u5185\u90e8\u662f"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"compilation.hooks.afterChunks.tap('WebAssemblyModulesPlugin', () => {\n    for (const chunk of compilation.chunks) {\n        if (chunk.canBeInitial()) {\n            for (const module of chunk.modulesIterable) {\n                if (module.type.startsWith('webassembly')) {\n                    initialWasmModules.add(module);\n                }\n            }\n        }\n    }\n    // .....\n});\n")),(0,r.kt)("p",null,"\u63a5\u4e0b\u6765\u5c31\u662f\u6267\u884c\u4e00\u5199 optimize \u7684 hooks"),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(3572).Z,width:"4133",height:"3734"})),(0,r.kt)("p",null,"#webpack"),(0,r.kt)("p",null,"#wip\n",(0,r.kt)("img",{src:t(6820).Z,width:"2390",height:"1687"}),"\n",(0,r.kt)("img",{src:t(7014).Z,width:"914",height:"1015"}),"\n",(0,r.kt)("img",{src:t(7938).Z,width:"2390",height:"1644"}),"\n",(0,r.kt)("img",{src:t(4595).Z,width:"1583",height:"932"}),"\n",(0,r.kt)("img",{src:t(3433).Z,width:"4165",height:"5081"})),(0,r.kt)("p",null,"[\u6df1\u5165\u7406\u89e3 webpack \u7684 chunkId \u5bf9\u7ebf\u4e0a\u7f13\u5b58\u7684\u601d\u8003]"," ",(0,r.kt)("a",{parentName:"p",href:"https://juejin.cn/post/6844903924818771981#heading-5"},"https://juejin.cn/post/6844903924818771981#heading-5")))}s.isMDXComponent=!0},3572:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/chunk-7ec7cc39c3886041f4aeddb0aa4a88c7.png"},6820:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/chunkGraph-chunk-6c319a00e0e072b053f9bc361bfa4637.png"},7014:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/chunkGraph-init-2cabec51b926f76a2a628650562a1610.png"},7938:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/chunkGraph-one-926624e40f1c9227d4f72a69c0b2dd4e.png"},4595:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/chunkGraph-29fb6648123372b2e699d68036959119.png"},3433:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/queue-3e8798afadc70611af90532ae04093e2.png"}}]);