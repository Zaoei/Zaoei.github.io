"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2368],{3912:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>c,toc:()=>o});var s=t(4848),i=t(5680);const r={},l="CSS SandBox",c={id:"micfrontend/\u6df1\u5165\u7406\u89e3QianKun/CSS SandBox/CSS SandBox",title:"CSS SandBox",description:"\u672c\u7bc7\u6587\u7ae0\u4e3b\u8981\u4ecb\u7ecd\u7684\u662f\u5173\u4e8eCSS Sandbox\u7684\u4e00\u4e9b\u4e8b\u60c5\uff0c\u4e3a\u4ec0\u4e48\u8981\u4ecb\u7ecd\u8fd9\u4e2a\u5462\uff1f\u5728\u6211\u4eec\u65e5\u5e38\u7684\u5f00\u53d1\u4e2d\uff0c\u6837\u5f0f\u95ee\u9898\u5176\u5b9e\u4e00\u76f4\u662f\u4e00\u4e2a\u6bd4\u8f83\u8017\u65f6\u7684\u4e8b\u60c5\uff0c\u4e00\u65b9\u9762\u6211\u4eec\u6839\u636eUI\u7a3f\u4e0d\u65ad\u7684\u53bb\u8c03\u6574\uff0c\u53e6\u4e00\u65b9\u9762\u968f\u7740\u9879\u76ee\u8d8a\u6765\u8d8a\u5927\u53ef\u80fd\u54ea\u4e00\u6b21\u5f00\u53d1\u5c31\u53d1\u73b0\u2014\u2014\u8bf6\uff0c\u6211\u7684\u6837\u5f0f\u600e\u4e48\u4e0d\u8d77\u4f5c\u7528\u4e86\uff0c\u4ea6\u6216\u662f\u600e\u4e48\u88ab\u53e6\u4e00\u4e2a\u6837\u5f0f\u6240\u8986\u76d6\u4e86\u3002\u539f\u56e0\u53ef\u80fd\u6709\u5f88\u591a\uff1a",source:"@site/docs/micfrontend/\u6df1\u5165\u7406\u89e3QianKun/CSS SandBox/CSS SandBox.md",sourceDirName:"micfrontend/\u6df1\u5165\u7406\u89e3QianKun/CSS SandBox",slug:"/micfrontend/\u6df1\u5165\u7406\u89e3QianKun/CSS SandBox/",permalink:"/docs/micfrontend/\u6df1\u5165\u7406\u89e3QianKun/CSS SandBox/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"communication",permalink:"/docs/micfrontend/practice/communication"},next:{title:"JS SandBox",permalink:"/docs/micfrontend/\u6df1\u5165\u7406\u89e3QianKun/JS SandBox/"}},d={},o=[{value:"CSS in JS",id:"css-in-js",level:2},{value:"\u4f18\u7f3a\u70b9",id:"\u4f18\u7f3a\u70b9",level:3},{value:"\u6837\u5f0f\u7ea6\u5b9a",id:"\u6837\u5f0f\u7ea6\u5b9a",level:2},{value:"\u4f18\u7f3a\u70b9",id:"\u4f18\u7f3a\u70b9-1",level:3},{value:"\u9884\u5904\u7406\u5668",id:"\u9884\u5904\u7406\u5668",level:2},{value:"\u4f18\u7f3a\u70b9",id:"\u4f18\u7f3a\u70b9-2",level:3},{value:"CSS Module",id:"css-module",level:2},{value:"\u4f18\u7f3a\u70b9",id:"\u4f18\u7f3a\u70b9-3",level:3},{value:"Shadow DOM",id:"shadow-dom",level:2},{value:"\u95ee\u9898\uff1a",id:"\u95ee\u9898",level:3},{value:"\u4f18\u7f3a\u70b9",id:"\u4f18\u7f3a\u70b9-4",level:3},{value:"strictStyleIsolation",id:"strictstyleisolation",level:2},{value:"<strong><strong>registerMicroApps\uff1a\u6ce8\u518c\u5b50\u5e94\u7528</strong></strong>",id:"registermicroapps\u6ce8\u518c\u5b50\u5e94\u7528",level:3},{value:"loadApp\uff1a\u52a0\u8f7d\u5b50\u5e94\u7528",id:"loadapp\u52a0\u8f7d\u5b50\u5e94\u7528",level:3},{value:"createElement\uff1a\u6dfb\u52a0shadow dom",id:"createelement\u6dfb\u52a0shadow-dom",level:3},{value:"experimentalStyleIsolation",id:"experimentalstyleisolation",level:2},{value:"createElement\uff1a\u7ed9\u6700\u5916\u5c42\u589e\u52a0data-qiankun\u5c5e\u6027\uff0c\u5e76\u4e14\u83b7\u53d6\u6240\u6709style\u6807\u7b7e",id:"createelement\u7ed9\u6700\u5916\u5c42\u589e\u52a0data-qiankun\u5c5e\u6027\u5e76\u4e14\u83b7\u53d6\u6240\u6709style\u6807\u7b7e",level:3},{value:"css.process\u8be6\u7ec6\u5904\u7406",id:"cssprocess\u8be6\u7ec6\u5904\u7406",level:3},{value:"\u8fdb\u5165processor.process\u770b\u770b\u5bf9\u5b83\u8fdb\u884c\u4e86\u4ec0\u4e48\u64cd\u4f5c",id:"\u8fdb\u5165processorprocess\u770b\u770b\u5bf9\u5b83\u8fdb\u884c\u4e86\u4ec0\u4e48\u64cd\u4f5c",level:3},{value:"\u8ba9\u6211\u4eec\u770b\u770brewrite\u5177\u4f53\u8fdb\u884c\u4e86\u4ec0\u4e48\u64cd\u4f5c\uff0c\u8fd9\u91cc\u4e3b\u8981\u5206\u4e3a\u4e24\u5757\uff1a",id:"\u8ba9\u6211\u4eec\u770b\u770brewrite\u5177\u4f53\u8fdb\u884c\u4e86\u4ec0\u4e48\u64cd\u4f5c\u8fd9\u91cc\u4e3b\u8981\u5206\u4e3a\u4e24\u5757",level:3},{value:"\u52a8\u6001\u6dfb\u52a0\u6837\u5f0f\u7684\u601d\u8003\ud83e\udd14",id:"\u52a8\u6001\u6dfb\u52a0\u6837\u5f0f\u7684\u601d\u8003",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.RP)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"css-sandbox",children:"CSS SandBox"}),"\n",(0,s.jsx)(n.h1,{id:"\u5f15\u8a00",children:"\u5f15\u8a00"}),"\n",(0,s.jsxs)(n.p,{children:["\u672c\u7bc7\u6587\u7ae0\u4e3b\u8981\u4ecb\u7ecd\u7684\u662f\u5173\u4e8e",(0,s.jsx)(n.code,{children:"CSS Sandbox"}),"\u7684\u4e00\u4e9b\u4e8b\u60c5\uff0c\u4e3a\u4ec0\u4e48\u8981\u4ecb\u7ecd\u8fd9\u4e2a\u5462\uff1f\u5728\u6211\u4eec\u65e5\u5e38\u7684\u5f00\u53d1\u4e2d\uff0c\u6837\u5f0f\u95ee\u9898\u5176\u5b9e\u4e00\u76f4\u662f\u4e00\u4e2a\u6bd4\u8f83\u8017\u65f6\u7684\u4e8b\u60c5\uff0c\u4e00\u65b9\u9762\u6211\u4eec\u6839\u636eUI\u7a3f\u4e0d\u65ad\u7684\u53bb\u8c03\u6574\uff0c\u53e6\u4e00\u65b9\u9762\u968f\u7740\u9879\u76ee\u8d8a\u6765\u8d8a\u5927\u53ef\u80fd\u54ea\u4e00\u6b21\u5f00\u53d1\u5c31\u53d1\u73b0\u2014\u2014\u8bf6\uff0c\u6211\u7684\u6837\u5f0f\u600e\u4e48\u4e0d\u8d77\u4f5c\u7528\u4e86\uff0c\u4ea6\u6216\u662f\u600e\u4e48\u88ab\u53e6\u4e00\u4e2a\u6837\u5f0f\u6240\u8986\u76d6\u4e86\u3002\u539f\u56e0\u53ef\u80fd\u6709\u5f88\u591a\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4e0d\u89c4\u8303\u7684\u547d\u540d\u5bfc\u81f4\u91cd\u590d"}),"\n",(0,s.jsx)(n.li,{children:"\u4e3a\u4e86\u7b80\u5355\uff0c\u76f4\u63a5\u6dfb\u52a0\u5168\u5c40\u6837\u5f0f\u7684\u4fee\u6539"}),"\n",(0,s.jsx)(n.li,{children:"\u6837\u5f0f\u7684\u4e0d\u5408\u7406\u590d\u7528"}),"\n",(0,s.jsx)(n.li,{children:"\u591a\u4e2a\u9879\u76ee\u5408\u5e76\u65f6\uff0c\u6bcf\u4e2a\u5b50\u9879\u76ee\u90fd\u6709\u81ea\u5df1\u7684\u72ec\u7acb\u6837\u5f0f\u548c\u914d\u7f6e\uff0c\u53ef\u80fd\u5728\u81ea\u5df1\u9879\u76ee\u4e2d\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u4f46\u662f\u5408\u5e76\u4ee5\u540e\u4e92\u76f8\u5f71\u54cd\u9020\u6210\u4e86\u6837\u5f0f\u6c61\u67d3"}),"\n",(0,s.jsx)(n.li,{children:"\u7b2c\u4e09\u65b9\u6846\u67b6\u5f15\u5165"}),"\n",(0,s.jsx)(n.li,{children:"\u2026\u2026"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u800c",(0,s.jsx)(n.code,{children:"CSS Sandbox"}),"\u6b63\u5f0f\u4e3a\u4e86\u9694\u79bb\u6837\u5f0f\uff0c\u4ece\u800c\u89e3\u51b3\u6837\u5f0f\u6c61\u67d3\u7684\u95ee\u9898"]}),"\n",(0,s.jsx)(n.h1,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n",(0,s.jsxs)(n.p,{children:["\u901a\u8fc7\u4e0a\u8ff0\u6211\u4eec\u4e86\u89e3\u4e86\u6837\u5f0f\u6c61\u67d3\u4ea7\u751f\u7684\u539f\u56e0\uff0c\u4ece\u4e2d\u6211\u4eec\u4e5f\u53ef\u4ee5\u603b\u7ed3\u4e00\u4e0b\u54ea\u4e9b\u573a\u666f\u65f6\u6211\u4eec\u9700\u8981\u4f7f\u7528",(0,s.jsx)(n.code,{children:"CSS Sandbox"}),"\u8fdb\u884c\u6837\u5f0f\u9694\u79bb\u5462"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5fae\u524d\u7aef\u573a\u666f\u4e0b\u7684\u7236\u5b50\u4ee5\u53ca\u5b50\u5b50\u5e94\u7528"}),"\n",(0,s.jsx)(n.li,{children:"\u5927\u578b\u9879\u76ee\u4ee5\u53ca\u590d\u6742\u9879\u76ee\u7684\u6837\u5f0f\u51b2\u7a81"}),"\n",(0,s.jsx)(n.li,{children:"\u7b2c\u4e09\u65b9\u6846\u67b6\u4ee5\u53ca\u81ea\u5b9a\u4e49\u4e3b\u9898\u6837\u5f0f\u7684\u8986\u76d6"}),"\n",(0,s.jsx)(n.li,{children:"\u2026\u2026"}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"\u5e38\u89c1\u7684\u89e3\u51b3\u65b9\u6848",children:"\u5e38\u89c1\u7684\u89e3\u51b3\u65b9\u6848"}),"\n",(0,s.jsxs)(n.p,{children:["\u65e2\u7136\u8bf4\u4e86\u8fd9\u4e48\u591a\u6837\u5f0f\u6c61\u67d3\u4ea7\u751f\u7684\u539f\u56e0\u548c\u5e94\u7528\u573a\u666f\uff0c\u90a3\u6211\u4eec\u8be5\u5982\u4f55\u89e3\u51b3\u4ed6\u4eec\u5462\uff0c\u76ee\u524d\u6709\u4ee5\u4e0b\u51e0\u79cd\u89e3\u51b3\u65b9\u6848\uff0c\u5176\u5b9e\u89e3\u51b3\u7684\u6838\u5fc3\u8fd8\u662f\u4e0d\u53d8\u7684\u2014\u2014",(0,s.jsx)(n.code,{children:"\u4f7fCSS\u9009\u62e9\u5668\u4f5c\u7528\u7684Dom\u5143\u7d20\u552f\u4e00"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(5970).A+"",width:"1734",height:"998"})}),"\n",(0,s.jsx)(n.p,{children:"Tips\uff1a\u5f53\u6211\u4eec\u5728\u5b9e\u9645\u7684\u5f00\u53d1\u4e2d\u53ef\u4ee5\u6839\u636e\u9879\u76ee\u7684\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u9009\u62e9"}),"\n",(0,s.jsx)(n.h2,{id:"css-in-js",children:"CSS in JS"}),"\n",(0,s.jsx)(n.p,{children:"\u770b\u540d\u5b57\u662f\u4e0d\u662f\u611f\u89c9\u5f88\u9ad8\u7ea7\uff0c\u76f4\u8bd1\u4e0b\u5c31\u662f\u7528JS\u53bb\u5199CSS\u6837\u5f0f\uff0c\u800c\u4e0d\u662f\u5199\u5728\u5355\u72ec\u7684\u6837\u5f0f\u6587\u4ef6\u91cc\u3002\u4f8b\u5982\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"<p style='color:red'>css in js</p>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u548c\u6211\u4eec\u4f20\u7edf\u7684\u5f00\u53d1\u601d\u60f3\u5f88\u4e0d\u4e00\u6837\uff0c\u4f20\u7edf\u7684\u5f00\u53d1\u539f\u5219\u662f",(0,s.jsx)(n.code,{children:"\u5173\u6ce8\u70b9\u5206\u79bb"}),"\uff0c\u5c31\u6bd4\u5982\u6211\u4eec\u5e38\u8bf4\u7684\u4e0d\u5199",(0,s.jsx)(n.code,{children:"\u884c\u5185\u6837\u5f0f"}),"\u3001",(0,s.jsx)(n.code,{children:"\u884c\u5185\u811a\u672c"}),"\uff0c\u5373HTML\u3001JS\u3001CSS\u90fd\u5199\u5728\u5bf9\u5e94\u7684\u6587\u4ef6\u91cc\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5173\u4e8eCSS in JS\u4e0d\u662f\u4e00\u4e2a\u65b0\u5174\u7684\u6280\u672f\uff0c\u4ed6\u7684\u70ed\u5ea6\u4e3b\u8981\u51fa\u73b0\u4e8e\u4e00\u4e9bWeb\u6846\u67b6\u7684\u53d1\u5c55\uff0c\u6bd4\u5982\u8bf4\uff1aReact\uff0c\u5b83\u6240\u652f\u6301\u7684jsx\u8bed\u6cd5\uff0c\u53ef\u4ee5\u8ba9\u6211\u4eec\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\u540c\u65f6\u5199js\u3001html\u548ccss\uff0c\u5e76\u4e14",(0,s.jsx)(n.code,{children:"\u7ec4\u4ef6"}),"\u5185\u90e8\u7ba1\u7406\u81ea\u5df1\u7684\u6837\u5f0f\u3001\u903b\u8f91\uff0c\u7ec4\u4ef6\u5316\u5f00\u53d1\u7684\u601d\u60f3\u6df1\u5165\u4eba\u5fc3\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"const style = {\n\tcolor: 'red'\n}\n\nReactDOM.render(\n  <p style={style}>\n     css in js\n  </h1>,\n  document.getElementById('main')\n);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u6837\u5f0f\u7531\u81ea\u8eab\u7684style\u51b3\u5b9a\uff0c\u4e0d\u4f9d\u8d56\u4e5f\u4e0d\u5f71\u54cd\u5916\u90e8\uff0c\u4ece\u8fd9\u4e00\u70b9\u6765\u770b\u786e\u5b9e\u5b9e\u73b0\u4e86\u6837\u5f0f\u9694\u79bb\u7684\u6548\u679c\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u5173\u4e8e",(0,s.jsx)(n.code,{children:"Css in js"}),"\u7684\u5e93\u4e5f\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u8bf4\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://styled-components.com/docs",children:"styled-components"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://polished.js.org/",children:"polished"})}),"\n",(0,s.jsx)(n.li,{children:"\xb7\xb7\xb7\xb7\xb7\xb7"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5176\u4e2dstyled-components\u4f1a\u52a8\u6001\u751f\u6210\u4e00\u4e2a\u9009\u62e9\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import styled from 'styled-components'\n\nfunction App() {\n  const Title = styled.h1`\n    font-size: 1.5em;\n    text-align: center;\n    color: palevioletred;\n  `;\n\n  return (\n    <div>\n      <Title>Hello World, this is my first styled component!</Title>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(2746).A+"",width:"3004",height:"1486"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4f18\u7f3a\u70b9",children:"\u4f18\u7f3a\u70b9"}),"\n",(0,s.jsx)(n.p,{children:"| \u4f18\u70b9 | \u2022 \u6ca1\u6709\u4f5c\u7528\u57df\u7684\u6837\u5f0f\u6c61\u67d3\u95ee\u9898\uff08\u4e3b\u8981\u6307\u7684\u662f\u901a\u8fc7\u5199\u5185\u884c\u6837\u5f0f\u4ee5\u53ca\u751f\u6210\u552f\u4e00\u7684css\u9009\u62e9\u5668\uff09\n\u2022 \u51cf\u5c11\u4e86\u65e0\u7528\u6837\u5f0f\u7684\u5806\u79ef\uff0c\u5220\u9664\u7ec4\u4ef6\u5373\u5220\u9664\u5bf9\u5e94\u7684\u6837\u5f0f\n\u2022 \u901a\u8fc7\u5bfc\u51fa\u5b9a\u4e49\u7684\u6837\u5f0f\u53d8\u91cf\u65b9\u4fbf\u8fdb\u884c\u590d\u7528\u548c\u91cd\u6784 |\n| --- | --- |\n| \u7f3a\u70b9 | \u2022 \u5185\u8054\u6837\u5f0f\u4e0d\u652f\u6301\u4f2a\u7c7b\u548c\u9009\u62e9\u5668\u7b49\u5199\u6cd5\n\u2022 \u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u6bd4\u8f83\u5dee\uff0c\u8fdd\u80cc\u4e86\u5173\u6ce8\u70b9\u5206\u79bb\u7684\u539f\u5219\n\u2022 \u8fd0\u884c\u65f6\u4f1a\u6d88\u8017\u6027\u80fd\uff0c\u52a8\u6001\u751f\u6210css\uff08\u6211\u4eec\u5728\u5199css\u65f6\u5176\u5b9e\u8fd8\u662fjs\uff09\n\u2022 \u4e0d\u80fd\u7ed3\u5408\u4e00\u4e9bCSS\u9884\u5904\u7406\u5668\uff0c\u65e0\u6cd5\u8fdb\u884c\u9884\u7f16\u8bd1 |"}),"\n",(0,s.jsx)(n.h2,{id:"\u6837\u5f0f\u7ea6\u5b9a",children:"\u6837\u5f0f\u7ea6\u5b9a"}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u8fc7\u7ea6\u5e94\u7528\u7684\u547d\u540d\u524d\u7f00\u5b9e\u73b0\u7edf\u4e00\u7684\u5f00\u53d1\u548c\u7ef4\u62a4\uff0c\u6bd4\u5982\u8bf4BEM\u7684\u547d\u540d\u65b9\u5f0f\uff0c\u901a\u8fc7\u5bf9\u5757\u3001\u5143\u7d20\u4ee5\u53ca\u4fee\u9970\u7b26\u4e09\u8005\u7684\u547d\u540d\u6765\u89c4\u8303\u7684\u63cf\u8ff0\u4e00\u4e2a\u7ec4\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:".dropdown-menu__item-button--disabled\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4f18\u7f3a\u70b9-1",children:"\u4f18\u7f3a\u70b9"}),"\n",(0,s.jsx)(n.p,{children:"| \u4f18\u70b9 | \u2022 \u6837\u5f0f\u9694\u79bb\n\u2022 \u8bed\u4e49\u5316\u5f3a\uff0c\u7ec4\u4ef6\u53ef\u8bfb\u6027\u9ad8 |\n| --- | --- |\n| \u7f3a\u70b9 | \u2022 \u547d\u540d\u592a\u957f\n\u2022 \u4f9d\u8d56\u4e8e\u5f00\u53d1\u8005\u7684\u547d\u540d |"}),"\n",(0,s.jsx)(n.h2,{id:"\u9884\u5904\u7406\u5668",children:"\u9884\u5904\u7406\u5668"}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u8fc7css\u9884\u5904\u7406\u5668\u53ef\u4ee5\u5904\u7406\u5f88\u591a\u72ec\u7279\u7684\u8bed\u6cd5\u683c\u5f0f\uff0c\u6bd4\u5982\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u53ef\u5d4c\u5957\u6027"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sass",children:"body {\n\twith: 20px;\n\tp {\n\t\tcolor: red;\n\t}\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u7236\u9009\u62e9\u5668"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sass",children:"body {\n\twith: 20px;\n\t&:hover {\n\t\twith: 30px;\n\t}\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5c5e\u6027\u7ee7\u627f"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-less",children:".dev {\n\twidth: 200px;\n}\n\nspan {\n\t.dev\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"......"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u8fc7\u8fd9\u4e9b\u7279\u6b8a\u7684\u8bed\u6cd5\u8ba9css\u66f4\u5bb9\u6613\u89e3\u8bfb\u548c\u7ef4\u62a4"}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u4e9b\u5e38\u89c1\u7684\u5e02\u573a\u4e0a\u7684\u9884\u5904\u7406\u5668"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sass"}),"\n",(0,s.jsx)(n.li,{children:"Less"}),"\n",(0,s.jsx)(n.li,{children:"Stylus"}),"\n",(0,s.jsx)(n.li,{children:"PostCss"}),"\n",(0,s.jsx)(n.li,{children:"......"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u4f18\u7f3a\u70b9-2",children:"\u4f18\u7f3a\u70b9"}),"\n",(0,s.jsx)(n.p,{children:"| \u4f18\u70b9 | \u2022 \u53ef\u8bfb\u6027\u8f83\u597d\uff0c\u65b9\u4fbf\u7406\u89e3\u548c\u7ef4\u62a4dom\u7ed3\u6784\n\u2022 \u5229\u7528\u5d4c\u5957\u7b49\u65b9\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u5927\u5e45\u5ea6\u89e3\u51b3\u6837\u5f0f\u6c61\u67d3\u7684\u95ee\u9898 |\n| --- | --- |\n| \u7f3a\u70b9 | \u2022\u9700\u8981\u589e\u52a0\u989d\u5916\u7684\u5305\uff0c\u501f\u52a9\u76f8\u5173\u7f16\u8bd1\u5de5\u5177 |"}),"\n",(0,s.jsx)(n.p,{children:"Tips\uff1a\u901a\u5e38\u4e0e\u7c7b\u4f3c\u4e8eBEM\u7684\u547d\u540d\u65b9\u5f0f\u7ed3\u5408\uff0c\u53ef\u4ee5\u8fbe\u5230\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\uff0c\u589e\u5f3a\u53ef\u8bfb\u6027\u4ee5\u53ca\u590d\u7528\u7684\u6548\u679c"}),"\n",(0,s.jsx)(n.h2,{id:"css-module",children:"CSS Module"}),"\n",(0,s.jsxs)(n.p,{children:["\u987e\u540d\u601d\u4e49\u5c31\u662f\u5c06css\u8fdb\u884c\u6a21\u5757\u5316\u5904\u7406\uff0c\u7f16\u8bd1\u597d\u540e\u53ef\u4ee5\u907f\u514d\u6837\u5f0f\u88ab\u6c61\u67d3\u7684\u95ee\u9898\uff0c\u4e0d\u8fc7\u4f9d\u8d56\u4e8e",(0,s.jsx)(n.strong,{children:"Webpack"}),"\u9700\u8981\u914d\u7f6e",(0,s.jsx)(n.code,{children:"css-loader"}),"\u7b49\u6253\u5305\u5de5\u5177\uff0c\u4ee5\u4e0b\u662f\u6211\u5728",(0,s.jsx)(n.code,{children:"create-react-app"}),"\u521b\u5efa\u7684\u9879\u76ee\u4e2d\u8fd0\u884c\uff0c\u7531\u4e8e\u5176\u5df2\u7ecf\u5728webpack\u914d\u7f6e\u4e86",(0,s.jsx)(n.code,{children:"css-loader"}),"\uff0c\u56e0\u6b64\u5728\u6b64\u7bc7\u6587\u7ae0\u4e2d\u4e0d\u5c55\u793a\u5177\u4f53\u914d\u7f6e"]}),"\n",(0,s.jsx)(n.p,{children:"index.ts\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import style from './style.module.css'\n\nfunction App() {\n\n  return (\n    <div>\n      <p className={style.text}>Css Module</p>\n    </div>\n  );\n}\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"style.module.css\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sass",children:".text {\n  color: red;\n}\n\n// \u7b49\u540c\u4e8e\n:local(.text) {\n    color: blue;\n}\n\n// \u8fd8\u6709\u4e00\u79cd\u5168\u5c40\u6a21\u5f0f\uff0c\u6b64\u65f6\u4e0d\u4f1a\u8fdb\u884c\u7f16\u8bd1\n:global(.text) {\n    color: blue;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(7936).A+"",width:"3014",height:"1538"})}),"\n",(0,s.jsx)(n.p,{children:"\u6253\u5305\u5de5\u5177\u4f1a\u540c\u65f6\u628astyle.text\u4ee5\u53catext\u7f16\u8bd1\u6210\u72ec\u4e00\u65e0\u4e8c\u7684\u503c"}),"\n",(0,s.jsx)(n.h3,{id:"\u4f18\u7f3a\u70b9-3",children:"\u4f18\u7f3a\u70b9"}),"\n",(0,s.jsx)(n.p,{children:"| \u4f18\u70b9 | \u2022 \u5b66\u4e60\u6210\u672c\u8f83\u4f4e\uff0c\u4e0d\u4f9d\u8d56\u4e8e\u4eba\u5de5\u7ea6\u675f\n\u2022 \u57fa\u672c\u4e0a\u80fd100%\u89e3\u51b3\u6837\u5f0f\u6c61\u67d3\u95ee\u9898\n\u2022 \u65b9\u4fbf\u5b9e\u73b0\u6a21\u5757\u7684\u590d\u7528 |\n| --- | --- |\n| \u7f3a\u70b9 | \u2022 \u53ea\u80fd\u5728\u6784\u5efa\u65f6\u4f7f\u7528\uff0c\u4f9d\u8d56\u4e8ecss-loader\u7b49\n\u2022 \u53ef\u8bfb\u6027\u5dee\uff0c\u5728\u63a7\u5236\u53f0\u8c03\u8bd5\u65f6\u51fa\u73b0hash\u503c\u4e0d\u65b9\u4fbf\u8c03\u8bd5 |"}),"\n",(0,s.jsx)(n.h2,{id:"shadow-dom",children:"Shadow DOM"}),"\n",(0,s.jsx)(n.p,{children:"\u5b83\u53ef\u4ee5\u5c06\u4e00\u4e2a\u9690\u85cf\u3001\u72ec\u7acb\u7684DOM\u9644\u52a0\u5230\u4e00\u4e2a\u5143\u7d20\u4e0a\u3002\u5f53\u6211\u4eec\u7528Shadow DOM\u5305\u88f9\u4e00\u4e2a\u5143\u7d20\u540e\uff0c\u5176\u5185\u6837\u5f0f\u4e0d\u4f1a\u5bf9\u5916\u90e8\u6837\u5f0f\u9020\u6210\u5f71\u54cd\uff0c\u5916\u90e8\u6837\u5f0f\u4e5f\u4e0d\u4f1a\u5bf9\u5176\u5185\u90e8\u9020\u6210\u5f71\u54cd"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(2347).A+"",width:"2146",height:"1378"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u521b\u5efa\u4e00\u4e2ashadow dom\uff0c\u6211\u8fd9\u91cc\u662f\u901a\u8fc7ref\u53bb\u62ff\u9644\u7740\u7684\u8282\u70b9\uff0c\u4e00\u822c\u53ef\u4ee5\u7528document\u53bb\u62ff\nimport './App.css'; // \u5b9a\u4e49\u4e86shadow-text\u7684\u6837\u5f0f\n\nfunction App() {\n  const divRef = useRef(null)\n\n  useEffect(() => {\n    if(divRef?.current) {\n      const { current } = divRef\n      const shadow = current.attachShadow({mode: 'open'}); // mode\u7528\u6765\u63a7\u5236\u80fd\u5426\u7528js\u83b7\u53d6shaow dom\u5185\u7684\u5143\u7d20\n      shadow.innerHTML = '<p className=\"shadow-text\">Here is some new text</p>';\n      console.log(current.shadowRoot)\n    }\n  }, [])\n\n  return (\n    <div>\n      <div ref={divRef} className='shadow-host'></div>\n    </div>\n  );\n}\n\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(912).A+"",width:"2950",height:"1356"})}),"\n",(0,s.jsx)(n.p,{children:"\u5916\u90e8\u6837\u5f0f\u65e0\u6cd5\u5f71\u54cdshadow dom\u5185\u90e8\u7684\u6837\u5f0f"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u518d\u6765\u770b\u4e0bshadow dom\u5185\u90e8\u5f97\u6837\u5f0f\u4f1a\u5f71\u54cd\u5916\u90e8\u6837\u5f0f\u5417\uff1f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"function App() {\n  useEffect(() => {\n    if(divRef?.current) {\n      const { current } = divRef\n      const shadow = current.attachShadow({mode: 'open'});\n      shadow.innerHTML = '<style>.shadow-h1 { color: red } </style><p class=\"shadow-h1\">Here is some new text</p>';\n      \n    }\n  }, [])\n\n  return (\n    <div>\n      <Title>Hello World, this is my first styled component!</Title>\n      <h1 className='shadow-h1'>lalla1</h1>\n      <div ref={divRef} className='shadow-host'></div>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(1185).A+"",width:"2974",height:"1442"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4f46\u662f\u4e5f\u6709\u4f8b\u5916\uff0c\u9664\u4e86",(0,s.jsx)(n.code,{children:"[:focus-within](https://developer.mozilla.org/zh-CN/docs/Web/CSS/:focus-within)"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import { useEffect, useRef } from 'react'\nimport './App.css'; // .shadow-host:focus-within { background-color: yellow;}\n\nfunction ShadowExample() {\n  const divRef = useRef(null)\n\n  useEffect(() => {\n    if(divRef?.current) {\n      const { current } = divRef\n      const shadow = current.attachShadow({mode: 'open'});\n      shadow.innerHTML = '<input class=\"shadow-h1\"/>';\n      \n    }\n  }, [])\n\n  return (\n    <div>\n      <p>Css Module</p>\n      <div ref={divRef} className='shadow-host'></div>\n    </div>\n  );\n}\n\nexport default ShadowExample;\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(594).A+"",width:"2318",height:"1384"})}),"\n",(0,s.jsx)(n.h3,{id:"\u95ee\u9898",children:"\u95ee\u9898\uff1a"}),"\n",(0,s.jsxs)(n.p,{children:["\u6b63\u7531\u4e8e",(0,s.jsx)(n.code,{children:"shadow dom"}),"\u5185\u7684\u6837\u5f0f\u53ea\u4f1a\u5e94\u7528\u4e8e\u5185\u90e8\uff0c\u5982\u679c\u6211\u4eec\u5728shadow dom\u5185\u90e8\u7528\u4e86\u7c7b\u4f3c\u4e8e",(0,s.jsx)(n.code,{children:"antd"}),"\u7684",(0,s.jsx)(n.code,{children:"Modal"}),"\u8fd9\u4e9b\u521b\u5efa\u4e8e",(0,s.jsx)(n.code,{children:"document.body"}),"\u4e0b\u7684\u5f39\u7a97\u6216\u8005\u5176\u4ed6\u7ec4\u4ef6\u65f6\uff0c\u65e0\u6cd5\u5e94\u7528\u4e8e",(0,s.jsx)(n.code,{children:"antd"}),"\u7684\u6837\u5f0f\uff0c\u9700\u8981\u628a",(0,s.jsx)(n.code,{children:"antd"}),"\u7684\u6837\u5f0f\u653e\u5230\u4e0a\u4e00\u5c42\u4e2d\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u4f18\u7f3a\u70b9-4",children:"\u4f18\u7f3a\u70b9"}),"\n",(0,s.jsx)(n.p,{children:"| \u4f18\u70b9 | \u2022 \u4e0d\u9700\u8981\u5f15\u5165\u989d\u5916\u7684\u5305\uff0c\u6d4f\u89c8\u5668\u539f\u751f\u652f\u6301\n\u2022 \u4e25\u683c\u9694\u79bb |\n| --- | --- |\n| \u7f3a\u70b9 | \u2022 \u5728\u67d0\u4e9b\u573a\u666f\u4e0b\u53ef\u80fd\u51fa\u73b0\u6837\u5f0f\u5931\u6548\u7684\u95ee\u9898\uff0c\u5982\u4e0a\u95ee\u9898\u4e2d\u7684shadow dom\u5185\u521b\u5efa\u4e86\u5168\u5c40\u7684Modal |"}),"\n",(0,s.jsx)(n.h1,{id:"\u6d45\u6790qiankun\u4e2d\u7684css-sandbox",children:"\u6d45\u6790QianKun\u4e2d\u7684CSS SandBox"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0a\u9762\u6211\u4eec\u8bb2\u89e3\u4e86\u4e00\u4e9b\u5b9e\u73b0\u6837\u5f0f\u9694\u79bb\u7684\u57fa\u672c\u65b9\u6848\uff0c\u90a3\u4f5c\u4e3a\u4e00\u4e2a\u6bd4\u8f83\u6210\u719f\u7684\u5fae\u524d\u7aef\u6846\u67b6",(0,s.jsx)(n.code,{children:"QianKun"}),"\u4e2d\u53c8\u662f\u600e\u4e48\u5b9e\u73b0\u6837\u5f0f\u9694\u79bb\u65b9\u6848\u7684\u5462\uff0c\u4ee5\u4e0b\u7684\u6e90\u7801\u89e3\u6790\u662f\u5728",(0,s.jsx)(n.code,{children:"v2.6.3"}),"\u7684\u7248\u672c\u4e0a\u7814\u7a76\u7684\uff0c\u9996\u5148\u901a\u8fc7\u770b\u6587\u6863\u53ef\u4ee5\u53d1\u73b0"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(6963).A+"",width:"2086",height:"146"})}),"\n",(0,s.jsx)(n.p,{children:"\u5728QianKun\u4e2dCSS SandBox\u6709\u4e24\u79cd\u6a21\u5f0f\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"strictStyleIsolation"}),"\u2014\u2014\u4e25\u683c\u6c99\u7bb1\u6a21\u5f0f"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"experimentalStyleIsolation"}),"\u2014\u2014\u5b9e\u9a8c\u6027\u6c99\u7bb1\u6a21\u5f0f"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"strictstyleisolation",children:"strictStyleIsolation"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\u8be5\u65b9\u6848\u4e0d\u662f\u4e00\u4e2a\u65e0\u8111\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5f00\u542f\u540e\u9700\u8981\u8fdb\u884c\u4e00\u5b9a\u7684\u9002\u914d"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u4e0b\u9762\u6211\u4eec\u6765\u8be6\u7ec6\u4ecb\u7ecd\u4e0b\u8be5\u6a21\u5f0f\uff1a"}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4eec\u8bbe\u7f6e",(0,s.jsx)(n.code,{children:"strictStyleIsolation"}),"\u4e3a",(0,s.jsx)(n.code,{children:"true"}),"\u65f6\uff0c",(0,s.jsx)(n.code,{children:"QianKun"}),"\u91c7\u7528\u7684\u662f",(0,s.jsx)(n.code,{children:"Shadow DOM"}),"\u65b9\u6848\uff0c\u6838\u5fc3\u5c31\u662f\u4e3a\u6bcf\u4e2a\u5fae\u5e94\u7528\u5305\u88f9\u4e0a\u4e00\u4e2aShadow DOM\u8282\u70b9\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u4e0b\u662f\u600e\u4e48\u5b9e\u73b0\u7684"]}),"\n",(0,s.jsx)(n.p,{children:"\u5148\u6765\u4e2a\u6d41\u7a0b\u56fe\u6211\u4eec\u6709\u4e2a\u5927\u81f4\u7684\u6982\u5ff5\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(4620).A+"",width:"1158",height:"1374"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.strong,{children:[(0,s.jsx)(n.code,{children:"registerMicroApps"}),"\uff1a\u6ce8\u518c\u5b50\u5e94\u7528\uff0c\u5bf9\u672a\u6ce8\u518c\u7684\u5e94\u7528\u8fdb\u884c\u8bb0\u5f55\uff0c\u540c\u65f6\u8c03\u7528single-spa\u4e2d\u7684",(0,s.jsx)(n.code,{children:"registerApplication"}),"\u8fdb\u884c\u6ce8\u518c"]})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"loadApp"}),"\uff1a\u52a0\u8f7d\u5b50\u5e94\u7528\uff0c\u521d\u59cb\u5316\u52a0\u8f7d\u5b50\u5e94\u7528\u7684Dom\u7ed3\u6784\uff0c\u521b\u5efa\u6837\u5f0f\u6c99\u7bb1\u548cJS\u6c99\u7bb1\u7b49\uff0c\u540c\u65f6\u8fd4\u56de\u4e0d\u540c\u9636\u6bb5\u7684\u751f\u547d\u5468\u671f"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"createElement"}),"\uff1a\u6837\u5f0f\u6c99\u7bb1\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u4e3b\u8981\u5206\u4e3a\u4e24\u79cd",(0,s.jsx)(n.code,{children:"strictStyleIsolation"}),"\u548c",(0,s.jsx)(n.code,{children:"experimentalStyleIsolation"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(1723).A+"",width:"2412",height:"1140"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(4080).A+"",width:"1772",height:"844"})}),"\n",(0,s.jsx)(n.h3,{id:"registermicroapps\u6ce8\u518c\u5b50\u5e94\u7528",children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.strong,{children:"registerMicroApps\uff1a\u6ce8\u518c\u5b50\u5e94\u7528"})})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"export function registerMicroApps<T extends ObjectType>(apps: Array<RegistrableApp<T>>,lifeCycles?: FrameworkLifeCycles<T>,) {\n...\n    registerApplication({\n      name,\n      app: async () => {\n        ...\n        // \u52a0\u8f7d\u5fae\u5e94\u7528\u7684\u5177\u4f53\u65b9\u6cd5\uff0c\u66b4\u9732bootstrap\u3001mount\u3001unmount\u7b49\u751f\u547d\u5468\u671f\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u914d\u7f6e\u4fe1\u606f\n        const { mount, ...otherMicroAppConfigs } = (\n          await loadApp({ name, props, ...appConfig }, frameworkConfiguration, lifeCycles)\n        )();\n\t\t\t\t...\n      },\n      // \u5b50\u5e94\u7528\u7684\u6fc0\u6d3b\u6761\u4ef6\n      activeWhen: activeRule\n\t\t\t...\n    });\n  });\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8c03\u7528single-spa\u7684registerApplication\u5bf9\u5e94\u7528\u8fdb\u884c\u6ce8\u518c\uff0c\u5e76\u4e14\u5728\u5e94\u7528\u6fc0\u6d3b\u7684\u65f6\u5019\u8c03\u7528app\u7684\u56de\u8c03\uff0c\u5176\u4e2d\u6700\u4e3b\u8981\u7684\u662f",(0,s.jsx)(n.code,{children:"loadApp"}),"\u52a0\u8f7d\u5fae\u5e94\u7528\u7684\u5177\u4f53\u65b9\u6cd5"]}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u4e9b\u53c2\u6570\u7684\u8bf4\u660e\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"apps"}),"\uff1a\u5fae\u5e94\u7528\u7684\u6ce8\u518c\u4fe1\u606f"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(329).A+"",width:"648",height:"350"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"lifeCycles"}),"\uff1a\u5fae\u5e94\u7528\u7684\u4e00\u4e9b\u751f\u547d\u5468\u671f\u94a9\u5b50"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(7286).A+"",width:"1558",height:"734"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"loadapp\u52a0\u8f7d\u5b50\u5e94\u7528",children:"loadApp\uff1a\u52a0\u8f7d\u5b50\u5e94\u7528"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"function loadApp (app: LoadableApp<T>, configuration: FrameworkConfiguration = {},lifeCycles?: FrameworkLifeCycles<T>) {\n...\n/**\n * \u5c06\u64cd\u4f5c\u6743\u4ea4\u7ed9\u4e3b\u5e94\u7528\u63a7\u5236\uff0c\u8fd4\u56de\u7ed3\u679c\u6d89\u53caCSS SandBox\u548cJS SandBox\n * template --template\u7684\u4e3alink\u66ff\u6362\u4e3astyle\u6ce8\u91cascript\u7684HTML\u6a21\u7248\n * execScripts --\u811a\u672c\u6267\u884c\u5668\uff0c\u8ba9\u6307\u5b9a\u7684\u811a\u672c(scripts)\u5728\u89c4\u5b9a\u7684\u4e0a\u4e0b\u6587\u73af\u5883\u4e2d\u6267\u884c\uff0c\u53ea\u505a\u4e86\u89e3\u6682\u65f6\u4e0d\u8bb2\n * assetPublicPath -- \u9759\u6001\u8d44\u6e90\u5730\u5740\uff0c\u53ea\u505a\u4e86\u89e3\u6682\u65f6\u4e0d\u8bb2\n */\nconst { template, execScripts, assetPublicPath } = await importEntry(entry, importEntryOpts);\n\n// \u7ed9\u5b50\u5e94\u7528\u5305\u88f9\u4e00\u5c42div\u540e\u7684\u5b50\u5e94\u7528html\u6a21\u7248, \u662f\u6a21\u7248\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\nconst appContent = getDefaultTplWrapper(appInstanceId)(template);\n\nlet initialAppWrapperElement: HTMLElement | null = createElement(\n    appContent,\n\t\t// \u662f\u5426\u5f00\u542f\u4e86\u4e25\u683c\u6a21\u5f0f\n    strictStyleIsolation,\n\t\t// \u662f\u5426\u5f00\u542f\u5b9e\u9a8c\u6027\u7684\u6837\u5f0f\u9694\u79bb\n    scopedCSS,\n\t\t// \u6839\u636e\u5e94\u7528\u540d\u751f\u6210\u7684\u552f\u4e00\u503c\uff0c\u552f\u4e00\u5219\u4e3aappName\uff0c\u4e0d\u552f\u4e00\u5219\u4e3aappName_[count]\u4e3a\u5177\u4f53\u6570\u91cf\uff0c\u91cd\u590d\u4f1acount++\n    appInstanceId,\n  );\n...\n// \u4e0b\u9762\u8fd8\u6709\u4e00\u4e9b\u751f\u547d\u5468\u671f\u7684\u5904\u7406\u65b9\u6cd5\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Q1\uff1a\u5230\u73b0\u5728\u4e0d\u77e5\u9053\u8fd8\u6709\u6ca1\u6709\u4eba\u8bb0\u5f97\u6211\u4eec\u5f00\u542f\u4e25\u683c\u6837\u5f0f\u6a21\u5f0f\u662f\u9700\u8981\u505a\u5565\uff1f"}),"\n",(0,s.jsx)(n.p,{children:"\uff01\uff01\uff01\u628a\u5b50\u5e94\u7528\u7684Dom\u7ed3\u6784\u653e\u5230Shadow dom\u4e2d\u4e0e\u4e3b\u5e94\u7528\u9694\u79bb\uff0c\u9632\u6b62\u6837\u5f0f\u6c61\u67d3"}),"\n",(0,s.jsx)(n.p,{children:"Q2\uff1a\u90a3\u6211\u4eec\u548b\u62ff\u5230\u5b50\u5e94\u7528\u7684dom\u7ed3\u6784\u5462\uff1f"}),"\n",(0,s.jsxs)(n.p,{children:["\u6ca1\u9519\u5c31\u662f\u901a\u8fc7",(0,s.jsx)(n.code,{children:"import-html-entry"}),"\u5e93\u7684",(0,s.jsx)(n.code,{children:"import-html-entry"}),"\u65b9\u6cd5\uff0c\u6709\u5174\u8da3\u7ed9\u770b\u4e0b\u5173\u4e8e",(0,s.jsx)(n.a,{href:"https://juejin.cn/post/6885212507837825038",children:"import-html-entry\u89e3\u6790"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(6303).A+"",width:"2966",height:"1082"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6ca1\u9519\u6211\u4eec\u62ff\u5230\u4e86",(0,s.jsx)(n.code,{children:"template"}),"\u3001",(0,s.jsx)(n.code,{children:"execScripts"}),"\u548c",(0,s.jsx)(n.code,{children:"assetPublicPath"}),"\uff0c\u8fd9\u91cc\u6211\u4eec\u4e0d\u5bf9\u540e\u4e24\u4e2a\u8fdb\u884c\u8bb2\u89e3\uff0c\u805a\u7126\u5230",(0,s.jsx)(n.code,{children:"template"}),"\u4e0a\uff1a"]}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u6bd4\u4e0b\u5b50\u5e94\u7528\u539f\u6765\u7684HTML\u7ed3\u6784"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(5460).A+"",width:"1801",height:"628"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u62ff\u5230\u7684",(0,s.jsx)(n.code,{children:"template"}),"\u662f",(0,s.jsx)(n.code,{children:"link"}),"\u6807\u7b7e\u53d8\u6210",(0,s.jsx)(n.code,{children:"style"}),"\u6807\u7b7e\u6ce8\u91ca\u4e86",(0,s.jsx)(n.code,{children:"script"}),"\u7684HTML\u6a21\u7248\uff0c\u5176\u4e2d\u5c31\u6709\u6211\u4eec\u9700\u8981\u7684\u5b50\u5e94\u7528\u7684Dom\u7ed3\u6784\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u62ff\u5230\u4ee5\u540eQianKun\u91cc\u53c8\u5728",(0,s.jsx)(n.code,{children:"template"}),"\u4e0a\u5305\u88f9\u4e86\u4e00\u5c42div\u5f62\u6210\u4e00\u4e2a\u65b0\u7684HTML\u7ed3\u6784\u7684\u6a21\u7248\u5b57\u7b26\u4e32\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\u4e3b\u8981\u662f\u4e3a\u4e86\u5728\u4e3b\u5e94\u7528\u4e2d\u6807\u8bc6\u8be5\u8282\u70b9\u4e0b\u7684\u5185\u5bb9\u4e3a\u5b50\u5e94\u7528\uff0c\u5f53\u7136\u5728\u540e\u9762\u6211\u4eec\u4e5f\u9700\u8981\u5b83\u8fdb\u884c\u7279\u522b\u7684\u5904\u7406\uff0c\u8fd9\u4e2a\u540e\u9762\u8bb2\u5230\u7684\u65f6\u5019\u518d\u8bf4\u3002\u56e0\u6b64\u6211\u4eec\u73b0\u5728\u62ff\u5230\u7684",(0,s.jsx)(n.code,{children:"appContent"}),"\u957f\u6210\u8fd9\u4e2a\u6837\u5b50\uff1a"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(8493).A+"",width:"2690",height:"848"})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u4e2adiv\u7684id\u662f\u552f\u4e00\u7684\u54c8\uff01\uff01\uff01"}),"\n",(0,s.jsxs)(n.p,{children:["\u90a3\u6211\u4eec\u73b0\u5728\u662f\u4e0d\u662f\u5df2\u7ecf\u505a\u597d\u4e86\u524d\u671f\u51c6\u5907\uff0c\u73b0\u5728\u6211\u4eec\u9700\u8981\u8fdb\u5165\u6700\u540e\u4e00\u4e2a\u6b65\u9aa4\uff0c\u628a\u5b50\u5e94\u7528\u7684\u8fd9\u4e2aDom\u7ed3\u6784\u6302\u8f7d\u5230\u4e00\u4e2ashadow dom\u4e0a\uff0c\u8fd9\u5c31\u8981\u7528\u5230",(0,s.jsx)(n.code,{children:"createElement"}),"\u65b9\u6cd5\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8fdb\u5165",(0,s.jsx)(n.code,{children:"createElement"}),"\u65b9\u6cd5\u524d\u6211\u4eec\u5148\u6765\u770b\u4e0b\u76ee\u524d\u7684\u53c2\u6570\u503c\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"appContent\uff1a\u5305\u88f9\u4e86\u4e00\u5c42id\u552f\u4e00\u7684div\uff0c\u5177\u4f53\u5982\u4e0a\u6240\u793a"}),"\n",(0,s.jsxs)(n.li,{children:["strictStyleIsolation\uff1a",(0,s.jsx)(n.code,{children:"true"})]}),"\n",(0,s.jsxs)(n.li,{children:["scopedCSS\uff1a",(0,s.jsx)(n.code,{children:"false"})]}),"\n",(0,s.jsxs)(n.li,{children:["appInstanceId\uff1a",(0,s.jsx)(n.code,{children:"react16"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"createelement\u6dfb\u52a0shadow-dom",children:"createElement\uff1a\u6dfb\u52a0shadow dom"}),"\n",(0,s.jsx)(n.p,{children:"\u90a3\u6211\u4eec\u73b0\u5728\u5982\u4f55\u53bb\u521b\u5efa\u4e00\u4e2ashadow dom\uff0c\u5728\u524d\u9762\u5173\u4e8eshadow dom\u7684\u8bb2\u89e3\u4e2d\u6211\u4eec\u77e5\u9053\uff0c\u521b\u5efa\u4e00\u4e2ashadow dom\u6211\u4eec\u9700\u8981\u4e24\u4e2a\u4e1c\u897f\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u3001\u6302\u8f7d\u7684dom\u8282\u70b9"}),"\n",(0,s.jsx)(n.p,{children:"\u4e8c\u3001\u9700\u8981\u6dfb\u52a0\u5230shadow dom\u7684\u5185\u5bb9"}),"\n",(0,s.jsxs)(n.p,{children:["\u90a3\u6211\u4eec\u4ece\u54ea\u91cc\u53bb\u627e\u5462\uff0c\u6839\u636e\u4f20\u8fdb\u6765\u7684\u53c2\u6570\u5427\uff0c\u6211\u4eec\u65e0\u7591\u662f\u8981\u5bf9",(0,s.jsx)(n.code,{children:"appContent"}),"\u8fdb\u884c\u5904\u7406\u4e86\uff0c\u56de\u987e\u4e0b",(0,s.jsx)(n.code,{children:"appContent"}),"\u6709\u4ec0\u4e48\uff0c\u5305\u88f9\u4e86\u4e00\u5c42div\u7684\u5b50\u5e94\u7528\u7684HTML\u6a21\u7248\u662f\u5427\uff0c\u81ea\u7136\u800c\u7136\u7684\u6211\u4eec\u5c31\u53ef\u4ee5\u4ee5\u5916\u9762\u7684div\u4e3a\u6302\u8f7d\u7684dom\u8282\u70b9\uff0c\u62ff\u5b50\u5e94\u7528\u7684HTML\u6a21\u7248\u4e3a\u9700\u8981\u6dfb\u52a0\u5230shadow dom\u7684\u5185\u5bb9\uff0c\u5373\uff1a"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(1898).A+"",width:"2438",height:"832"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4f46\u662f\u95ee\u9898\u53c8\u6765\u4e86\uff0c \u76ee\u524d\u7684",(0,s.jsx)(n.code,{children:"appContent"}),"\u662f\u6a21\u7248\u5b57\u7b26\u4e32\u561e\uff0c\u6211\u4eec\u548b\u529e\uff1f\u8fd9\u8fb9QianKun\u7684\u5904\u7406\u65b9\u6848\u662f\uff1a"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(7107).A+"",width:"792",height:"1378"})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u53ea\u662f\u4e2a\u5927\u81f4\u6d41\u7a0b\uff0c\u4e0b\u9762\u8ba9\u6211\u4eec\u8ddf\u7740\u8fd9\u6837\u7684\u601d\u60f3\u770b\u4e0b\u4ee3\u7801\u91cc\u5904\u7406\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"function createElement(appContent: string,strictStyleIsolation: boolean,scopedCSS: boolean,appInstanceId: string) {\n...\nconst containerElement = document.createElement('div');\n  containerElement.innerHTML = appContent;\n  const appElement = containerElement.firstChild as HTMLElement;\n\t// \u4e25\u683c\u6837\u5f0f\u6c99\u7bb1\u6a21\u5f0f\n  if (strictStyleIsolation) {\n    if (!supportShadowDOM) {\n      console.warn(\n        '[qiankun]: As current browser not support shadow dom, your strictStyleIsolation configuration will be ignored!',\n      );\n    } else {\n      const { innerHTML } = appElement;\n      appElement.innerHTML = '';\n      let shadow: ShadowRoot;\n\n\t\t\t// \u521b\u5efashadow dom\u8282\u70b9\n      if (appElement.attachShadow) {\n        shadow = appElement.attachShadow({ mode: 'open' });\n      } else {\n        // \u517c\u5bb9\u4f4e\u7248\u672c\n        shadow = (appElement as any).createShadowRoot();\n      }\n      shadow.innerHTML = innerHTML;\n    }\n  }\n...\n// \u6b64\u5904\u7701\u7565\u4e86\u5f00\u542fexperimentalStyleIsolation\u7684\u5904\u7406\u65b9\u6cd5\n...\nreturn appElement;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u91cc\u6709\u4e2a\u5f88\u6709\u610f\u601d\u7684\u662f\uff1a"}),"\n",(0,s.jsxs)(n.p,{children:["appContent\u4ee5innerHTML\u53d8\u6210dom\u7ed3\u6784\u540e\uff0cHTML\u6a21\u7248\u4e2d\u7684",(0,s.jsx)(n.code,{children:"<html>"}),"\u3001",(0,s.jsx)(n.code,{children:"<head>"}),"\u4ee5\u53ca",(0,s.jsx)(n.code,{children:"<body>"}),"\u4f1a\u88ab\u53bb\u6389"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(9587).A+"",width:"2910",height:"1464"})}),"\n",(0,s.jsx)(n.p,{children:"\u6700\u540e\u6211\u4eec\u518d\u6765\u770b\u4e0b\u5b50\u5e94\u7528\u6302\u8f7d\u5230\u4e3b\u5e94\u7528\u7684Dom\u7ed3\u6784\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(9754).A+"",width:"1674",height:"794"})}),"\n",(0,s.jsx)(n.p,{children:"\u7b14\u8005\u5728\u5b9e\u8df5\u7684\u8fc7\u7a0b\u4e2d\u4e5f\u9047\u5230\u4e86\u4e00\u4e9b\u95ee\u9898\uff1a"}),"\n",(0,s.jsxs)(n.p,{children:["1\u3001\u5fae\u5e94\u7528\u4e2d\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u5f15\u5165\u56fe\u7247\u51fa\u73b0\u52a0\u8f7d\u8d44\u6e90404\u7684\u95ee\u9898\uff0c\u8fd9\u8fb9\u7b14\u8005\u6ca1\u6709\u8fdb\u884c\u8fc7\u591a\u7684\u5c1d\u8bd5\u53ef\u4ee5\u53c2\u8003\u4e0b\u5b98\u65b9\u7684\uff1a",(0,s.jsx)(n.a,{href:"https://qiankun.umijs.org/zh/faq#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BE%AE%E5%BA%94%E7%94%A8%E5%8A%A0%E8%BD%BD%E7%9A%84%E8%B5%84%E6%BA%90%E4%BC%9A-404",children:"https://qiankun.umijs.org/zh/faq#\u4e3a\u4ec0\u4e48\u5fae\u5e94\u7528\u52a0\u8f7d\u7684\u8d44\u6e90\u4f1a-404"})]}),"\n",(0,s.jsx)(n.p,{children:"2\u3001\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\u5c31\u662freact\u4e2d\u52a8\u6001\u6253\u5f00Modal\u5931\u6548\u7684\u95ee\u9898\uff0c\u539f\u56e0\u53ef\u4ee5\u770b\u4e0b\u2023\uff0c\u5927\u6982\u770b\u4e86\u4e0b\u548cReact\u7684\u4e8b\u4ef6\u673a\u5236\u6709\u5173\uff0c\u5373\u4f7f\u662f\u8bbe\u7f6e\u5f39\u7a97\u9ed8\u8ba4\u5f00\u542f\uff0c\u4e5f\u4f1a\u51fa\u73b0\u4e4b\u524d\u4e0a\u9762\u63d0\u5230\u7684\uff0c\u6837\u5f0f\u4e22\u5931\u7684\u95ee\u9898"}),"\n",(0,s.jsx)(n.p,{children:"\uff01\uff01\uff01\u770b\u4e0b\u4e00\u4e2a\u4e4b\u524d\u7b80\u5355\u56de\u987e\u4e0b\u5427\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014"}),"\n",(0,s.jsx)(n.h2,{id:"experimentalstyleisolation",children:"experimentalStyleIsolation"}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4eec\u8bbe\u7f6e",(0,s.jsx)(n.code,{children:"experimentalStyleIsolation"}),"\u4e3a",(0,s.jsx)(n.code,{children:"true"}),"\u65f6\uff0c",(0,s.jsx)(n.code,{children:"QianKun"}),"\u91c7\u7528\u7684\u662f",(0,s.jsx)(n.code,{children:"Runtime css transformer"})," \u52a8\u6001\u52a0\u8f7d/\u5378\u8f7d\u6837\u5f0f\u8868\u65b9\u6848\uff0c\u4e3a\u5b50\u5e94\u7528\u7684\u6837\u5f0f\u8868\u589e\u52a0\u4e00\u4e2a\u7279\u6b8a\u7684\u9009\u62e9\u5668\u4ece\u800c\u9650\u5b9a\u5f71\u54cd\u8303\u56f4\uff0c\u7c7b\u4f3c\u4ee5\u4e0b\u7ed3\u6784\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'// \u5047\u8bbe\u5e94\u7528\u540d\u662f react16\n<style>\n.app-main {\n  font-size: 14px;\n}\n</style>\n\n<style>\ndiv[data-qiankun="react16"] .app-main {\n  font-size: 14px;\n}\n<style>\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5148\u6765\u901a\u8fc7\u6d41\u7a0b\u56fe\u4e86\u89e3\u4e0b\u5927\u81f4\u6d41\u7a0b"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"111.png",src:t(2293).A+"",width:"3153",height:"5106"})}),"\n",(0,s.jsx)(n.h3,{id:"createelement\u7ed9\u6700\u5916\u5c42\u589e\u52a0data-qiankun\u5c5e\u6027\u5e76\u4e14\u83b7\u53d6\u6240\u6709style\u6807\u7b7e",children:"createElement\uff1a\u7ed9\u6700\u5916\u5c42\u589e\u52a0data-qiankun\u5c5e\u6027\uff0c\u5e76\u4e14\u83b7\u53d6\u6240\u6709style\u6807\u7b7e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"function createElement(appContent: string, strictStyleIsolation: boolean, scopedCSS: boolean,appInstanceId: string) {\n...\nif (scopedCSS) {\n\t\t// \u7ed9\u6700\u5916\u5c42\u8bbe\u7f6edata-qiankun\u7684\u5c5e\u6027\n    const attr = appElement.getAttribute(css.QiankunCSSRewriteAttr);\n    if (!attr) {\n      appElement.setAttribute(css.QiankunCSSRewriteAttr, appInstanceId);\n    }\n\t\t// \u83b7\u53d6\u6240\u6709\u7684style\u6807\u7b7e,\u8fdb\u884c\u904d\u5386\n    const styleNodes = appElement.querySelectorAll('style') || [];\n    forEach(styleNodes, (stylesheetElement: HTMLStyleElement) => {\n      css.process(appElement!, stylesheetElement, appInstanceId);\n    });\n  }\n...\n}\n\nexport const QiankunCSSRewriteAttr = 'data-qiankun';\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u6765\u770b\u4e0b\u8bbe\u7f6e\u5b8c\u5c5e\u6027\u540e\u7684\u5c5e\u6027\u540e\u7684appElement"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(936).A+"",width:"2242",height:"494"})}),"\n",(0,s.jsx)(n.p,{children:"styleNodes"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(5427).A+"",width:"692",height:"110"})}),"\n",(0,s.jsx)(n.h3,{id:"cssprocess\u8be6\u7ec6\u5904\u7406",children:"css.process\u8be6\u7ec6\u5904\u7406"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:'/**\n* \u5b9e\u4f8b\u5316ScopedCSS\n* \u751f\u6210\u6839\u5143\u7d20\u5c5e\u6027\u9009\u62e9\u5668[data-qiankun="\u5e94\u7528\u540d"]\u524d\u7f00\n*/\nexport const process = (\n  appWrapper: HTMLElement,\n  stylesheetElement: HTMLStyleElement | HTMLLinkElement,\n  appName: string,\n): void => {\n  // \u5b9e\u4f8b\u5316ScopedCSS\n  if (!processor) {\n    processor = new ScopedCSS();\n  }\n\t...\n\t// \u4e00\u4e9b\u7a7a\u503c\u7684\u5904\u7406\n  const mountDOM = appWrapper;\n  if (!mountDOM) {\n    return;\n  }\n\n  const tag = (mountDOM.tagName || \'\').toLowerCase();\n\n  if (tag && stylesheetElement.tagName === \'STYLE\') {\n\t\t// \u751f\u6210\u524d\u7f00\uff0c\u6839\u5143\u7d20\u6807\u7b7e\u540d[data-qiankun="\u5e94\u7528\u540d"]\n    const prefix = `${tag}[${QiankunCSSRewriteAttr}="${appName}"]`;\n    processor.process(stylesheetElement, prefix);\n  }\n};\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"prefix\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:'div[data-qiankun="react16"]'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"stylesheetElement\uff1a"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(6570).A+"",width:"742",height:"244"})}),"\n",(0,s.jsx)(n.h3,{id:"\u8fdb\u5165processorprocess\u770b\u770b\u5bf9\u5b83\u8fdb\u884c\u4e86\u4ec0\u4e48\u64cd\u4f5c",children:"\u8fdb\u5165processor.process\u770b\u770b\u5bf9\u5b83\u8fdb\u884c\u4e86\u4ec0\u4e48\u64cd\u4f5c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u91cd\u5199\u6837\u5f0f\u9009\u62e9\u5668\u4ee5\u53ca\u5bf9\u4e8e\u7a7a\u7684style\u8282\u70b9\u8bbe\u7f6eMutationObserver\u76d1\u542c\uff0c\u539f\u56e0\u53ef\u80fd\u5b58\u5728\u52a8\u6001\u589e\u52a0\u6837\u5f0f\u7684\u60c5\u51b5\nprocess(styleNode: HTMLStyleElement, prefix: string = '') {\n\t\t// \u5f53style\u6807\u7b7e\u6709\u5185\u5bb9\u65f6\u8fdb\u884c\u64cd\u4f5c\n    if (styleNode.textContent !== '') {\n\t\t\t// styleNode.textContent\u4e3astyle\u6807\u7b7e\u5185\u7684\u5185\u5bb9\n      const textNode = document.createTextNode(styleNode.textContent || '');\n\t\t\t// swapNode\u4e3a\u521b\u5efa\u7684\u7a7a\u7684style\u6807\u7b7e\n      this.swapNode.appendChild(textNode);\n\t\t\t// \u83b7\u53d6\u6837\u5f0f\u8868\n      const sheet = this.swapNode.sheet as any;\n\t\t\t// \u4ece\u6837\u5f0f\u8868\u83b7\u53d6cssRules\u8be5\u503c\u662f\u6807\u51c6\u7684\uff0c\u628a\u6837\u5f0f\u89c4\u5219\u4ece\u4f2a\u6570\u7ec4\u8f6c\u5316\u6210\u6570\u7ec4\n      const rules = arrayify<CSSRule>(sheet?.cssRules ?? []);\n\t\t\t// \u901a\u8fc7\u904d\u5386\u548c\u6b63\u5219\u91cd\u5199\u6bcf\u4e2a\u9009\u62e9\u5668\u7684\u524d\u7f00\n      const css = this.rewrite(rules, prefix);\n\t\t\t// \u5c06\u5904\u7406\u540e\u7684\u91cd\u5199\u540e\u7684css\u653e\u5165\u539f\u6765\u7684styleNode\u4e2d\n      styleNode.textContent = css;\n      // \u6e05\u7406\u5de5\u5177\u4ebaswapNode\n      this.swapNode.removeChild(textNode);\n      return;\n    }\n\n\t\t//\u5bf9\u7a7a\u7684\u6837\u5f0f\u8282\u70b9\u8fdb\u884c\u76d1\u542c\uff0c\u53ef\u80fd\u5b58\u5728\u52a8\u6001\u63d2\u5165\u7684\u95ee\u9898\n    const mutator = new MutationObserver((mutations) => {\n      for (let i = 0; i < mutations.length; i += 1) {\n\t\t\t\t// mutation\u4e3a\u53d8\u66f4\u7684\u6bcf\u4e2a\u8bb0\u5f55MutationRecord\n        const mutation = mutations[i];\n\n\t\t\t\t// \u5224\u65ad\u8be5\u8282\u70b9\u662f\u5426\u5e94\u5904\u7406\u8fc7\n        if (ScopedCSS.ModifiedTag in styleNode) {\n          return;\n        }\n\n        if (mutation.type === 'childList') {\n          const sheet = styleNode.sheet as any;\n          const rules = arrayify<CSSRule>(sheet?.cssRules ?? []);\n          const css = this.rewrite(rules, prefix);\n\n          styleNode.textContent = css;\n          // \u589e\u52a0\u5904\u7406\u8282\u70b9\u7684\u6807\u8bc6\n          (styleNode as any)[ScopedCSS.ModifiedTag] = true;\n        }\n      }\n    });\n\n    // \u76d1\u542c\u5f53\u524d\u7684style\u6807\u7b7e\uff0c\u5f53styleNode\u4e3a\u7a7a\u7684\u65f6\u5019\uff0c\u4ee5\u53ca\u53d8\u66f4\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u5f15\u5165\u7684antd\u6837\u5f0f\u6587\u4ef6\n    mutator.observe(styleNode, { childList: true });\n  }\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Q1\uff1a\u4e3a\u4ec0\u4e48\u5728",(0,s.jsx)(n.code,{children:"style"}),"\u6807\u7b7e\u6709\u5185\u5bb9\u7684\u65f6\u5019\u4f7f\u7528",(0,s.jsx)(n.code,{children:"this.swapNode"}),"\u8fd9\u4e2a\u5de5\u5177\u4eba\uff0c\u800c\u5728\u76d1\u542c\u7684\u65f6\u5019\u4e0d\u4f7f\u7528\uff1f"]}),"\n",(0,s.jsx)(n.p,{children:"\u8fd8\u8bb0\u5f97\u6211\u4eec\u662f\u9700\u8981\u5e72\u4ec0\u4e48\u5417\uff1f"}),"\n",(0,s.jsxs)(n.p,{children:["\u6539\u5199",(0,s.jsx)(n.code,{children:"style"}),"\u6807\u7b7e\u5185\u7684\u6837\u5f0f\u89c4\u5219"]}),"\n",(0,s.jsxs)(n.p,{children:["\u56e0\u6b64\u8fd9\u91cc\u5c31\u901a\u8fc7",(0,s.jsx)(n.code,{children:"style.sheet.cssRules"}),"\u65b9\u5f0f\u53bb\u83b7\u53d6style\u6807\u7b7e\u91cc\u7684\u6bcf\u4e00\u6761\u89c4\u5219\u8fdb\u884c\u91cd\u5199\uff0c\u6211\u4eec\u6765\u770b\u4e0b",(0,s.jsx)(n.code,{children:"sheet"}),"\u6837\u5f0f\u8868\u7684\u6570\u636e\u7ed3\u6784"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(4885).A+"",width:"1299",height:"344"})}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u8fc7\u8fd9\u4e2a\u7ed3\u6784\u6211\u4eec\u5176\u5b9e\u4e0b\u4e00\u6b65\u60f3\u8981\u505a\u7684\u4e8b\u60c5\u5f88\u6e05\u695a\u4e86"}),"\n",(0,s.jsxs)(n.p,{children:["\u5c31\u662f\u91cd\u5199\u6bcf\u4e00\u6761",(0,s.jsx)(n.code,{children:"cssRules"}),"\u5e76\u4e14\u901a\u8fc7\u5b57\u7b26\u4e32\u62fc\u63a5\u8d4b\u503c\u7ed9",(0,s.jsx)(n.code,{children:"style"}),"\u6807\u7b7e"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Untitled",src:t(1820).A+"",width:"2754",height:"504"})}),"\n",(0,s.jsx)(n.p,{children:"\u4f46\u662f\u6211\u4eec\u5f97\u6ce8\u610f\u4e24\u70b9\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u9009\u62e9\u5668\u4e0d\u540c\u6211\u4eec\u7684\u5904\u7406\u65b9\u5f0f\u4e5f\u4e0d\u540c"}),"\n",(0,s.jsx)(n.li,{children:"\u5bf9\u9009\u62e9\u5668\u7684\u5339\u914d\u89c4\u5219\u7684\u5904\u7406"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u8ba9\u6211\u4eec\u770b\u770brewrite\u5177\u4f53\u8fdb\u884c\u4e86\u4ec0\u4e48\u64cd\u4f5c\u8fd9\u91cc\u4e3b\u8981\u5206\u4e3a\u4e24\u5757",children:"\u8ba9\u6211\u4eec\u770b\u770brewrite\u5177\u4f53\u8fdb\u884c\u4e86\u4ec0\u4e48\u64cd\u4f5c\uff0c\u8fd9\u91cc\u4e3b\u8981\u5206\u4e3a\u4e24\u5757\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u4e00\u5bf9\u9009\u62e9\u5668\u7684\u7c7b\u578b\u8fdb\u884c\u5224\u65ad"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/CSSRule/type",children:"CSSRule.type"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"private rewrite(rules: CSSRule[], prefix: string = '') {\n    let css = '';\n\n    rules.forEach((rule) => {\n      switch (rule.type) {\n\t      // \u666e\u901a\u9009\u62e9\u5668\u7c7b\u578b\n        case RuleType.STYLE:\n          css += this.ruleStyle(rule as CSSStyleRule, prefix);\n          break;\n\t\t\t\t// @media\u9009\u62e9\u5668\u7c7b\u578b\n        case RuleType.MEDIA:\n          css += this.ruleMedia(rule as CSSMediaRule, prefix);\n          break;\n\t\t\t\t// @supports\u9009\u62e9\u5668\u7c7b\u578b\n        case RuleType.SUPPORTS:\n          css += this.ruleSupport(rule as CSSSupportsRule, prefix);\n          break;\n        default:\n          css += `${rule.cssText}`;\n          break;\n      }\n    });\n\n    return css;\n  }\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4e8c\u662f\u8fdb\u884c\u6b63\u5219\u66ff\u6362"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u7279\u6b8a\u7684"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u5904\u7406\u7c7b\u4f3c\u4e8e@media screen and (min-width: 900px) {}\nprivate ruleMedia(rule: CSSMediaRule, prefix: string) {\n  const css = this.rewrite(arrayify(rule.cssRules), prefix);\n  return `@media ${rule.conditionText} {${css}}`;\n}\n\n// \u5904\u7406\u7c7b\u4f3c\u4e8e@supports (display: grid) {}\nprivate ruleSupport(rule: CSSSupportsRule, prefix: string) {\n  const css = this.rewrite(arrayify(rule.cssRules), prefix);\n  return `@supports ${rule.conditionText} {${css}}`;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u666e\u901a\u7684"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// prefix\u4e3a\"div[data-qiankun=\"react16\"]\"\nprivate ruleStyle(rule: CSSStyleRule, prefix: string) {\n\t\t// \u6839\u9009\u62e9\u5668\uff0c\u6bd4\u5982body\u3001html\u4ee5\u53ca:root\n    const rootSelectorRE = /((?:[^\\w\\-.#]|^)(body|html|:root))/gm;\n\t\t// \u6839\u7ec4\u5408\u9009\u62e9\u5668\uff0c\u7c7b\u4f3c\u4e8e html body{...}\n    const rootCombinationRE = /(html[^\\w{[]+)/gm;\n\n\t\t// \u83b7\u53d6\u9009\u62e9\u5668\n    const selector = rule.selectorText.trim();\n\n\t\t// \u83b7\u53d6\u6837\u5f0f\u6587\u672c\uff0c\u6bd4\u5982\"html { font-family: sans-serif; line-height: 1.15; text-size-adjust: 100%; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); }\"\n    let { cssText } = rule;\n\t   // \u5bf9\u6839\u9009\u62e9\u5668(body\u3001html\u3001:root)\u8fdb\u884c\u5224\u65ad\uff0c\u66ff\u6362\u6210prefix\n    if (selector === 'html' || selector === 'body' || selector === ':root') {\n      return cssText.replace(rootSelectorRE, prefix);\n    }\n\n    // \u5bf9\u4e8e\u6839\u7ec4\u5408\u9009\u62e9\u5668\u8fdb\u884c\u5339\u914d\n    if (rootCombinationRE.test(rule.selectorText)) {\n      const siblingSelectorRE = /(html[^\\w{]+)(\\+|~)/gm;\n\t\t\t// \u5bf9\u4e8e\u975e\u6807\u51c6\u7684\u5144\u5f1f\u9009\u62e9\u5668\u8f6c\u6362\u65f6\u8fdb\u884c\u5ffd\u7565\uff0c\u7f6e\u7a7a\u5904\u7406\n      if (!siblingSelectorRE.test(rule.selectorText)) {\n        cssText = cssText.replace(rootCombinationRE, '');\n      }\n    }\n\n    // \u666e\u901a\u9009\u62e9\u5668\u5339\u914d\n    cssText = cssText.replace(/^[\\s\\S]+{/, (selectors) =>\n\t\t\t// selectors\u4e3a\u7c7b\u4f3c\u4e8e.link{\n      selectors.replace(/(^|,\\n?)([^,]+)/g, (item, p, s) => {\n\t\t\t\t// \u5904\u7406\u7c7b\u4f3c\u4e8ediv,body,span { ... }\uff0c\u542b\u6709\u6839\u5143\u7d20\u7684\n        if (rootSelectorRE.test(item)) {\n          return item.replace(rootSelectorRE, (m) => {\n            const whitePrevChars = [',', '('];\n\t\t\t\t\t\t// \u5c06\u5176\u4e2d\u7684\u6839\u5143\u7d20\u66ff\u6362\u4e3a\u524d\u7f00\u4fdd\u7559,\u6216\u8005\uff08\n            if (m && whitePrevChars.includes(m[0])) {\n              return `${m[0]}${prefix}`;\n            }\n\t\t\t\t\t\t// \u76f4\u63a5\u628a\u6839\u5143\u7d20\u66ff\u6362\u6210\u524d\u7f00\n            return prefix;\n          });\n        }\n\n        return `${p}${prefix} ${s.replace(/^ */, '')}`;\n      }),\n    );\n\n    return cssText;\n  }\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u52a8\u6001\u6dfb\u52a0\u6837\u5f0f\u7684\u601d\u8003",children:"\u52a8\u6001\u6dfb\u52a0\u6837\u5f0f\u7684\u601d\u8003\ud83e\udd14"}),"\n",(0,s.jsxs)(n.p,{children:["\u90a3\u4e48\u901a\u8fc7JS\u52a8\u6001\u6dfb\u52a0\u7684",(0,s.jsx)(n.code,{children:"style"}),"\u3001",(0,s.jsx)(n.code,{children:"link"}),"\u6216\u8005",(0,s.jsx)(n.code,{children:"script"}),"\u6807\u7b7e\u90fd\u662f\u4e0d\u662f\u4e5f\u9700\u8981\u8fd0\u884c\u5728\u76f8\u5e94\u7684",(0,s.jsx)(n.code,{children:"CSS"}),"\u6216\u8005",(0,s.jsx)(n.code,{children:"JS"}),"\u6c99\u7bb1\u4e2d\u5462\uff0c\u6dfb\u52a0\u8fd9\u4e9b\u6807\u7b7e\u7684\u5e38\u89c1\u65b9\u6cd5\u65e0\u7591\u662f",(0,s.jsx)(n.code,{children:"createElement"}),"\u3001",(0,s.jsx)(n.code,{children:"appendChild"}),"\u548c",(0,s.jsx)(n.code,{children:"insertBefore"}),"\uff0c\u90a3\u5176\u5b9e\u6211\u4eec\u53ea\u8981\u5bf9\u4ed6\u4eec\u8bbe\u7f6e\u76d1\u542c\u5c31\u53ef\u4ee5\u4e86"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"dynamicAppend"}),"\u5c31\u662f\u7528\u6765\u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898\u7684\uff0c\u5b83\u66b4\u9732\u4e86\u4e24\u4e2a\u65b9\u6cd5"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"patchStrictSandbox\uff1aQianKun JS\u6c99\u7bb1\u6a21\u5f0f\u7684\u591a\u4f8b\u6a21\u5f0f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"patchStrictSandbox.png",src:t(9140).A+"",width:"2660",height:"3020"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"patchStrictSandbox"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"export function patchStrictSandbox(\n  appName: string,\n\t// \u8fd4\u56de\u5305\u88f9\u5b50\u5e94\u7528\u7684\u90a3\u4e00\u5757Dom\u7ed3\u6784\n  appWrapperGetter: () => HTMLElement | ShadowRoot,\n  proxy: Window,\n  mounting = true,\n  scopedCSS = false,\n  excludeAssetFilter?: CallableFunction,\n){\n  ...\nlet containerConfig = proxyAttachContainerConfigMap.get(proxy);\n  if (!containerConfig) {\n    containerConfig = {\n      appName,\n      proxy,\n      appWrapperGetter,\n      dynamicStyleSheetElements: [],\n      strictGlobal: true,\n      excludeAssetFilter,\n      scopedCSS,\n    };\n\t\t// \u5efa\u7acb\u4e86\u4ee3\u7406\u5bf9\u8c61\u548c\u5b50\u5e94\u7528\u914d\u7f6e\u4fe1\u606fMap\u5173\u7cfb\n    proxyAttachContainerConfigMap.set(proxy, containerConfig);\n  }\n\n\t// \u91cd\u5199Document.prototype.createElement\n  const unpatchDocumentCreate = patchDocumentCreateElement();\n\n\t// \u91cd\u5199appendChild\u3001insertBefore\n  const unpatchDynamicAppendPrototypeFunctions = patchHTMLDynamicAppendPrototypeFunctions(\n    (element) => elementAttachContainerConfigMap.has(element),\n    (element) => elementAttachContainerConfigMap.get(element)!,\n  );\n  ...\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u6269\u5c55",(0,s.jsx)(n.code,{children:"Document.prototype.createElement"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u6269\u5c55",(0,s.jsx)(n.code,{children:"appendChild"}),"\u3001",(0,s.jsx)(n.code,{children:"insertBefore"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"patchDocumentCreateElement"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"function patchDocumentCreateElement() {\n\t// \u8bb0\u5f55createElement\u662f\u5426\u88ab\u91cd\u5199\n  const docCreateElementFnBeforeOverwrite = docCreatePatchedMap.get(document.createElement);\n\n  if (!docCreateElementFnBeforeOverwrite) {\n    const rawDocumentCreateElement = document.createElement;\n\t\t// \u91cd\u5199Document.prototype.createElement\n    Document.prototype.createElement = function createElement<K extends keyof HTMLElementTagNameMap>(\n      this: Document,\n      tagName: K,\n      options?: ElementCreationOptions,\n    ): HTMLElement {\n      const element = rawDocumentCreateElement.call(this, tagName, options);\n\t\t\t// \u5224\u65ad\u521b\u5efa\u7684\u662f\u5426\u4e3astyle\u3001link\u548cscript\u6807\u7b7e\n      if (isHijackingTag(tagName)) {\n        const { window: currentRunningSandboxProxy } = getCurrentRunningApp() || {};\n        if (currentRunningSandboxProxy) {\n\t\t\t\t\t// \u83b7\u53d6\u5b50\u5e94\u7528\u7684\u914d\u7f6e\u4fe1\u606f\n          const proxyContainerConfig = proxyAttachContainerConfigMap.get(currentRunningSandboxProxy);\n          if (proxyContainerConfig) {\n            // \u5efa\u7acb\u65b0\u5143\u7d20element\u548c\u5b50\u5e94\u7528\u914d\u7f6e\u7684\u5bf9\u5e94\u5173\u7cfb\n            elementAttachContainerConfigMap.set(element, proxyContainerConfig);\n          }\n        }\n      }\n\n      return element;\n    };\n\n    if (document.hasOwnProperty('createElement')) {\n\t\t\t// \u91cd\u5199\n      document.createElement = Document.prototype.createElement;\n    }\n\n    docCreatePatchedMap.set(Document.prototype.createElement, rawDocumentCreateElement);\n  }\n}\n\nfunction isHijackingTag(tagName?: string) {\n  return (\n    tagName?.toUpperCase() === LINK_TAG_NAME ||\n    tagName?.toUpperCase() === STYLE_TAG_NAME ||\n    tagName?.toUpperCase() === SCRIPT_TAG_NAME\n  );\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u91cd\u5199",(0,s.jsx)(n.code,{children:"document.createElement"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u5efa\u7acb\u65b0\u5143\u7d20element\u548c\u5b50\u5e94\u7528\u914d\u7f6e\u7684\u5bf9\u5e94\u5173\u7cfb",(0,s.jsx)(n.code,{children:"elementAttachContainerConfigMap"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"patchHTMLDynamicAppendPrototypeFunctions"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"export function patchHTMLDynamicAppendPrototypeFunctions(\n  isInvokedByMicroApp: (element: HTMLElement) => boolean,\n  containerConfigGetter: (element: HTMLElement) => ContainerConfig,\n) {\n  // \u5f53appendChild\u548cinsertBefore\u6ca1\u6709\u88ab\u91cd\u5199\u7684\u65f6\u5019\n  if (\n    HTMLHeadElement.prototype.appendChild === rawHeadAppendChild &&\n    HTMLBodyElement.prototype.appendChild === rawBodyAppendChild &&\n    HTMLHeadElement.prototype.insertBefore === rawHeadInsertBefore\n  ) {\n    HTMLHeadElement.prototype.appendChild = getOverwrittenAppendChildOrInsertBefore({\n      rawDOMAppendOrInsertBefore: rawHeadAppendChild,\n      containerConfigGetter,\n      isInvokedByMicroApp,\n    }) as typeof rawHeadAppendChild;\n    HTMLBodyElement.prototype.appendChild = getOverwrittenAppendChildOrInsertBefore({\n      rawDOMAppendOrInsertBefore: rawBodyAppendChild,\n      containerConfigGetter,\n      isInvokedByMicroApp,\n    }) as typeof rawBodyAppendChild;\n\n    HTMLHeadElement.prototype.insertBefore = getOverwrittenAppendChildOrInsertBefore({\n      rawDOMAppendOrInsertBefore: rawHeadInsertBefore as any,\n      containerConfigGetter,\n      isInvokedByMicroApp,\n    }) as typeof rawHeadInsertBefore;\n  }}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5f53appendChild\u3001appendChild\u548cinsertBefore\u6ca1\u6709\u88ab\u91cd\u5199\u7684\u65f6\u5019\u8fdb\u884c\u91cd\u5199"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"getOverwrittenAppendChildOrInsertBefore"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"function getOverwrittenAppendChildOrInsertBefore(opts: {\n  rawDOMAppendOrInsertBefore: <T extends Node>(newChild: T, refChild?: Node | null) => T;\n  isInvokedByMicroApp: (element: HTMLElement) => boolean;\n  containerConfigGetter: (element: HTMLElement) => ContainerConfig;\n}) {\n  return function appendChildOrInsertBefore<T extends Node>(\n    this: HTMLHeadElement | HTMLBodyElement,\n    newChild: T,\n    refChild: Node | null = null,\n  ) {\n    let element = newChild as any;\n    const { rawDOMAppendOrInsertBefore, isInvokedByMicroApp, containerConfigGetter } = opts;\n    // \u5f53\u4e0d\u662fstyle\u3001link\u6216\u8005\u662fscript\u6807\u7b7e\u7684\u65f6\u5019\u6216\u8005\u5728\u5143\u7d20\u7684\u521b\u5efa\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u5b50\u5e94\u7528\u914d\u7f6e\u4fe1\u606f\u65f6\uff0c\u8d70\u539f\u751f\u7684\u65b9\u6cd5\n    if (!isHijackingTag(element.tagName) || !isInvokedByMicroApp(element)) {\n      return rawDOMAppendOrInsertBefore.call(this, element, refChild) as T;\n    }\n\n    if (element.tagName) {\n      // \u83b7\u53d6\u5f53\u524d\u5b50\u5e94\u7528\u7684\u914d\u7f6e\u4fe1\u606f\n      const containerConfig = containerConfigGetter(element);\n      const {\n        appName,\n        appWrapperGetter,\n        proxy,\n        strictGlobal,\n        dynamicStyleSheetElements,\n        scopedCSS,\n        excludeAssetFilter,\n      } = containerConfig;\n\n      switch (element.tagName) {\n        case LINK_TAG_NAME:\n        case STYLE_TAG_NAME: {\n          let stylesheetElement: HTMLLinkElement | HTMLStyleElement = newChild as any;\n          const { href } = stylesheetElement as HTMLLinkElement;\n          // \u914d\u7f6e\u9879\u4e0d\u9700\u8981\u88ab\u52ab\u6301\u7684\u8d44\u6e90\n          if (excludeAssetFilter && href && excludeAssetFilter(href)) {\n            return rawDOMAppendOrInsertBefore.call(this, element, refChild) as T;\n          }\n\n          // \u6302\u8f7d\u7684dom\u7ed3\u6784\uff0c\u5373\u5b50\u5e94\u7528\u7684dom\u7ed3\u6784\n          const mountDOM = appWrapperGetter();\n\n          // \u5982\u679c\u5f00\u542f\u4e86\u5b9e\u9a8c\u6027\u7684\u6837\u5f0f\u6c99\u7bb1\u6a21\u5f0f\n          if (scopedCSS) {\n            // exclude link elements like <link rel=\"icon\" href=\"favicon.ico\">\n            const linkElementUsingStylesheet =\n              element.tagName?.toUpperCase() === LINK_TAG_NAME &&\n              (element as HTMLLinkElement).rel === 'stylesheet' &&\n              (element as HTMLLinkElement).href;\n            // \u5bf9\u4e8elink\u6807\u7b7e\u8fdb\u884c\u6837\u5f0f\u8d44\u6e90\u4e0b\u8f7d\uff0c\u5e76\u8fdb\u884c\u6837\u5f0f\u7684\u91cd\u5199\n            if (linkElementUsingStylesheet) {\n              const fetch =\n                typeof frameworkConfiguration.fetch === 'function'\n                  ? frameworkConfiguration.fetch\n                  : frameworkConfiguration.fetch?.fn;\n              stylesheetElement = convertLinkAsStyle(\n                element,\n                (styleElement) => css.process(mountDOM, styleElement, appName),\n                fetch,\n              );\n              dynamicLinkAttachedInlineStyleMap.set(element, stylesheetElement);\n            } else {\n              css.process(mountDOM, stylesheetElement, appName);\n            }\n          }\n\n          // \u91cd\u5199\u4ee5\u540e\u7684style\u6807\u7b7e\n          dynamicStyleSheetElements.push(stylesheetElement);\n          const referenceNode = mountDOM.contains(refChild) ? refChild : null;\n          return rawDOMAppendOrInsertBefore.call(mountDOM, stylesheetElement, referenceNode);\n        }\n\t...\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"patchLooseSandbox\uff1aQianKun JS\u6c99\u7bb1\u6a21\u5f0f\u7684\u5355\u4f8b\u6a21\u5f0f\u548c\u5feb\u7167\u6a21\u5f0f\u4e0b"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"patchLooseSandbox.png",src:t(7265).A+"",width:"2660",height:"2522"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"export function patchLooseSandbox(\n  appName: string,\n  appWrapperGetter: () => HTMLElement | ShadowRoot,\n  proxy: Window,\n  mounting = true,\n  scopedCSS = false,\n  excludeAssetFilter?: CallableFunction,\n): Freer {\n  let dynamicStyleSheetElements: Array<HTMLLinkElement | HTMLStyleElement> = [];\n\n  const unpatchDynamicAppendPrototypeFunctions = patchHTMLDynamicAppendPrototypeFunctions(\n    // \u5224\u65ad\u5f53\u524d\u5fae\u5e94\u7528\u662f\u5426\u8fd0\u884c\n\t\t() => checkActivityFunctions(window.location).some((name) => name === appName),\n    // \u8fd4\u56de\u5fae\u5e94\u7528\u7684\u914d\u7f6e\u4fe1\u606f\n\t\t() => ({\n      appName,\n      appWrapperGetter,\n      proxy,\n      strictGlobal: false,\n      scopedCSS,\n      dynamicStyleSheetElements,\n      excludeAssetFilter,\n    }),\n  );\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7531\u4e8e\u662f\u5355\u4f8b\u6a21\u5f0f\u4fee\u6539\u7684\u8fd8\u662f\u5168\u5c40\u7684window\u53bb\u6389\u4e86\u5bf9",(0,s.jsx)(n.code,{children:"document.createElement"}),"\u7684\u91cd\u5199\uff0c\u4e0d\u9700\u8981\u5efa\u7acb\u5fae\u5e94\u7528\u548c\u65b0\u5efa\u5143\u7d20\u7684\u4e00\u4e00\u5bf9\u5e94"]})]})}function p(e={}){const{wrapper:n}={...(0,i.RP)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},5680:(e,n,t)=>{t.d(n,{RP:()=>o});var s=t(6540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,s,i=function(e,n){if(null==e)return{};var t,s,i={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var d=s.createContext({}),o=function(e){var n=s.useContext(d),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},a={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},p=s.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,d=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),h=o(t),x=i,m=h["".concat(d,".").concat(x)]||h[x]||a[x]||r;return t?s.createElement(m,l(l({ref:n},p),{},{components:t})):s.createElement(m,l({ref:n},p))}));p.displayName="MDXCreateElement"},7936:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/css-module-c1dae3a71ba0b4855fd57f960e9f6ffb.png"},2293:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/experimentalStyleIsolation-5c37f0ce02e2ba50516fda33c13da802.png"},936:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/experimentalStyleIsolation1-a7160cb7bb05a10b3927f30099116fdf.png"},5427:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/experimentalStyleIsolation2-1b99f67e596eb294b766ab927c9a4309.png"},6570:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/experimentalStyleIsolation3-65317c3a950bee05b9349490ba2778ae.png"},4885:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/experimentalStyleIsolation4-580d70c7d6b84f1eee5ded88982be30b.png"},1820:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/experimentalStyleIsolation5-2acf7a8bb0f4f77623e7453b1cedea5b.png"},7265:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/patchLooseSandbox-2b54fc301c0f3f3b0c4e71b965825f0c.png"},9140:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/patchStrictSandbox-c6207c8d748f193c9153b1a22aa9cbba.png"},6963:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/qiankunApi-e0c677bb3a6b8f068a2ee67eb5ea418a.png"},2347:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/shadowDom-a15aec72f79b6076ee3a29feb3dbf46f.png"},912:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/shadowDom\u4f8b\u5b501-2a11532d196f7778e271a3d5a9f0dba0.png"},1185:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/shadowDom\u4f8b\u5b502-35e5e8ba89bc9859a5c895ec823b6ad4.png"},594:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/shadowDom\u4f8b\u5b503-7470b63a5594d8dcd8229ee409d58fe9.png"},1723:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation1-4d7aba4f70f3dfbee2f51d7ddfc110cd.png"},9587:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation10-2da6059e6329caa9be3d77c6c01210bf.png"},9754:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation11-26fc5e46711d13072ab2e3c6b5197fa1.png"},4080:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation2-b2e152836b86acf4b58f3c25b06313cb.png"},329:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation3-c89cdbe4ae5b1de30db3cfec7889e487.png"},7286:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation4-b4e8a0ed5b4e6e360b1ed94c32252b60.png"},6303:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation5-909dc9cb1f1f63404bf81ccd95438164.png"},5460:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation6-0df3292326eeb7c35d6efe9ae0aee3dd.png"},8493:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation7-755cd43bfb1ae03ac67a420e8e5d403e.png"},1898:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation8-bc268c416c51209d5c339a90df341eba.png"},7107:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation9-4d0323c9692b77ac7f3dd02085218fdd.png"},4620:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/strictStyleIsolation\u6d41\u7a0b\u56fe-f40032414f2ecb9342efef2023e78a24.png"},2746:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/styled-components-d2ba10d0c4cfdab7e50e3d24aab0e4d1.png"},5970:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/\u5b9e\u73b0\u6837\u5f0f\u6c99\u7bb1\u7684\u65b9\u5f0f-8b9702907f0e7752cceeaedf93634766.png"}}]);